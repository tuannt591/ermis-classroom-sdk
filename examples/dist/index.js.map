{"version":3,"file":"index.js","sources":["../src/events/EventEmitter.js","../src/api/ApiClient.js","../src/core/Participant.js","../src/media/Publisher.js","../src/media/Subscriber.js","../src/media/AudioMixer.js","../src/core/Room.js","../src/core/SubRoom.js","../src/core/ErmisClient.js","../src/index.js"],"sourcesContent":["/**\n * Base EventEmitter class for handling events across the SDK\n */\nclass EventEmitter {\n  constructor() {\n    this._events = new Map();\n  }\n\n  on(event, listener) {\n    if (!this._events.has(event)) {\n      this._events.set(event, []);\n    }\n    this._events.get(event).push(listener);\n    return this;\n  }\n\n  off(event, listener) {\n    if (!this._events.has(event)) return this;\n\n    const listeners = this._events.get(event);\n    const index = listeners.indexOf(listener);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n\n    if (listeners.length === 0) {\n      this._events.delete(event);\n    }\n    return this;\n  }\n\n  emit(event, ...args) {\n    if (!this._events.has(event)) return false;\n\n    const listeners = this._events.get(event);\n    listeners.forEach((listener) => {\n      try {\n        listener(...args);\n      } catch (error) {\n        console.error(`Error in event listener for ${event}:`, error);\n      }\n    });\n    return true;\n  }\n\n  once(event, listener) {\n    const onceWrapper = (...args) => {\n      this.off(event, onceWrapper);\n      listener(...args);\n    };\n    return this.on(event, onceWrapper);\n  }\n\n  removeAllListeners(event) {\n    if (event) {\n      this._events.delete(event);\n    } else {\n      this._events.clear();\n    }\n    return this;\n  }\n\n  listenerCount(event) {\n    return this._events.has(event) ? this._events.get(event).length : 0;\n  }\n}\n\nexport default EventEmitter;\n","/**\n * API Client for handling HTTP requests to Ermis Meeting API\n */\nclass ApiClient {\n  constructor(config) {\n    this.host = config.host || \"daibo.ermis.network:9999\";\n    this.apiBaseUrl = config.apiUrl || `https://${this.host}/meeting`;\n    this.jwtToken = null;\n    this.userId = null;\n  }\n\n  /**\n   * Set authentication token and user ID\n   */\n  setAuth(token, userId) {\n    this.jwtToken = token;\n    this.userId = userId;\n  }\n\n  /**\n   * Generic API call method\n   */\n  async apiCall(endpoint, method = \"GET\", body = null) {\n    if (!this.userId) {\n      throw new Error(\"Please authenticate first\");\n    }\n\n    if (!this.jwtToken) {\n      throw new Error(\"JWT token not found\");\n    }\n\n    const options = {\n      method,\n      headers: {\n        Authorization: `Bearer ${this.jwtToken}`,\n        \"Content-Type\": \"application/json\",\n      },\n    };\n\n    if (body) {\n      options.body = JSON.stringify(body);\n    }\n\n    try {\n      const response = await fetch(`${this.apiBaseUrl}${endpoint}`, options);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error(\"API call failed:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get dummy token for authentication\n   */\n  async getDummyToken(userId) {\n    const endpoint = \"/get-token\";\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ sub: userId }),\n    };\n\n    try {\n      const response = await fetch(`${this.apiBaseUrl}${endpoint}`, options);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error(\"Token request failed:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new room\n   */\n  async createRoom(roomName, roomType = \"main\") {\n    return await this.apiCall(\"/rooms\", \"POST\", {\n      room_name: roomName,\n      room_type: roomType,\n    });\n  }\n\n  /**\n   * List available rooms\n   */\n  async listRooms(page = 1, perPage = 20) {\n    return await this.apiCall(\"/rooms/list\", \"POST\", {\n      list_query: {\n        page,\n        per_page: perPage,\n        sort_by: \"created_at\",\n        sort_order: \"desc\",\n      },\n      conditions: {\n        is_active: true,\n      },\n    });\n  }\n\n  /**\n   * Get room details by ID\n   */\n  async getRoomById(roomId) {\n    return await this.apiCall(`/rooms/${roomId}`);\n  }\n\n  /**\n   * Join a room by room code\n   */\n  async joinRoom(roomCode, appName = \"Ermis-Meeting\") {\n    return await this.apiCall(\"/rooms/join\", \"POST\", {\n      room_code: roomCode,\n      app_name: appName,\n    });\n  }\n\n  /**\n   * Create a sub room\n   */\n  async createSubRoom(parentRoomId, subRoomName, subRoomType = \"breakout\") {\n    return await this.apiCall(\"/rooms\", \"POST\", {\n      room_name: subRoomName,\n      room_type: subRoomType,\n      parent_room_id: parentRoomId,\n    });\n  }\n\n  /**\n   * Get sub rooms of a parent room\n   */\n  async getSubRooms(parentRoomId) {\n    return await this.apiCall(`/rooms/${parentRoomId}/sub-rooms`);\n  }\n\n  /**\n   * Leave a room\n   */\n  async leaveRoom(roomId, membershipId) {\n    return await this.apiCall(\n      `/rooms/${roomId}/members/${membershipId}`,\n      \"DELETE\"\n    );\n  }\n\n  /**\n   * Switch to sub room\n   */\n  async switchToSubRoom(roomId, subRoomCode) {\n    return await this.apiCall(\"/rooms/switch\", \"POST\", {\n      room_id: roomId,\n      sub_room_code: subRoomCode,\n    });\n  }\n\n  /**\n   * Get room members\n   */\n  async getRoomMembers(roomId) {\n    return await this.apiCall(`/rooms/${roomId}/members`);\n  }\n\n  /**\n   * Update room settings\n   */\n  async updateRoom(roomId, updates) {\n    return await this.apiCall(`/rooms/${roomId}`, \"PATCH\", updates);\n  }\n\n  /**\n   * Delete/Close room\n   */\n  async deleteRoom(roomId) {\n    return await this.apiCall(`/rooms/${roomId}`, \"DELETE\");\n  }\n}\n\nexport default ApiClient;\n","import EventEmitter from \"../events/EventEmitter.js\";\n\n/**\n * Represents a participant in a meeting room\n */\nclass Participant extends EventEmitter {\n  constructor(config) {\n    super();\n\n    this.userId = config.userId;\n    this.streamId = config.streamId;\n    this.membershipId = config.membershipId;\n    this.role = config.role || \"participant\";\n    this.roomId = config.roomId;\n    this.isLocal = config.isLocal || false;\n\n    // Media state\n    this.isAudioEnabled = true;\n    this.isVideoEnabled = true;\n    this.isPinned = false;\n\n    // Media components\n    this.publisher = null;\n    this.subscriber = null;\n    this.videoElement = null;\n    this.tile = null;\n\n    // Status\n    this.connectionStatus = \"disconnected\"; // 'connecting', 'connected', 'disconnected', 'failed'\n  }\n\n  /**\n   * Get display name with role\n   */\n  getDisplayName() {\n    const roleText = this.role === \"owner\" ? \" (Host)\" : \"\";\n    const localText = this.isLocal ? \" (You)\" : \"\";\n    return `${this.userId}${roleText}${localText}`;\n  }\n\n  /**\n   * Create video tile DOM element\n   */\n  createVideoTile() {\n    const tile = document.createElement(\"div\");\n    tile.className = \"video-tile\";\n    tile.setAttribute(\"data-user-id\", this.userId);\n    tile.setAttribute(\"data-stream-id\", this.streamId);\n\n    if (this.isLocal) {\n      tile.innerHTML = this._getLocalTileHTML();\n    } else {\n      tile.innerHTML = this._getRemoteTileHTML();\n    }\n\n    this.tile = tile;\n    this.videoElement = tile.querySelector(\"video\");\n    this._setupTileEvents();\n\n    this.emit(\"tileCreated\", { participant: this, tile });\n    return tile;\n  }\n\n  /**\n   * Get HTML for local participant tile\n   */\n  _getLocalTileHTML() {\n    return `\n      <video autoplay playsinline style=\"transform: scaleX(-1);\"></video>\n      <div class=\"user-label\">${this.getDisplayName()}</div>\n      <div class=\"status\">Connecting...</div>\n      <div class=\"controls\">\n        <button class=\"mic-btn\" id=\"micBtn-${this.streamId}\">\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"/>\n            <path d=\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z\"/>\n          </svg>\n        </button>\n        <button class=\"cam-btn\" id=\"camBtn-${this.streamId}\">\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n          </svg>\n        </button>\n        <button class=\"pin-btn\" id=\"pinBtn-${this.streamId}\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z\"/>\n          </svg>\n        </button>\n      </div>\n    `;\n  }\n\n  /**\n   * Get HTML for remote participant tile\n   */\n  _getRemoteTileHTML() {\n    return `\n      <video autoplay muted playsinline style=\"transform: scaleX(-1);\"></video>\n      <div class=\"user-label\">${this.getDisplayName()}</div>\n      <div class=\"status\">Connecting...</div>\n      <div class=\"subscriber-controls\">\n        <button class=\"audio-btn\" id=\"audioBtn-${this.streamId}\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/>\n          </svg>\n        </button>\n        <button class=\"pin-btn\" id=\"pinBtn-${this.streamId}\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z\"/>\n          </svg>\n        </button>\n      </div>\n    `;\n  }\n\n  /**\n   * Setup event listeners for tile controls\n   */\n  _setupTileEvents() {\n    if (!this.tile) return;\n\n    if (this.isLocal) {\n      this._setupLocalControls();\n    } else {\n      this._setupRemoteControls();\n    }\n\n    // Pin button\n    const pinBtn = this.tile.querySelector(`#pinBtn-${this.streamId}`);\n    pinBtn?.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      this.togglePin();\n    });\n  }\n\n  /**\n   * Setup controls for local participant\n   */\n  _setupLocalControls() {\n    const micBtn = this.tile.querySelector(`#micBtn-${this.streamId}`);\n    const camBtn = this.tile.querySelector(`#camBtn-${this.streamId}`);\n\n    micBtn?.addEventListener(\"click\", async () => {\n      await this.toggleMicrophone();\n    });\n\n    camBtn?.addEventListener(\"click\", async () => {\n      await this.toggleCamera();\n    });\n  }\n\n  /**\n   * Setup controls for remote participant\n   */\n  _setupRemoteControls() {\n    const audioBtn = this.tile.querySelector(`#audioBtn-${this.streamId}`);\n\n    audioBtn?.addEventListener(\"click\", async (e) => {\n      e.stopPropagation();\n      await this.toggleRemoteAudio();\n    });\n  }\n\n  /**\n   * Toggle microphone (local only)\n   */\n  async toggleMicrophone() {\n    if (!this.isLocal || !this.publisher) return;\n\n    try {\n      await this.publisher.toggleMic();\n      this.isAudioEnabled = !this.isAudioEnabled;\n      this._updateMicButton();\n      this.emit(\"audioToggled\", {\n        participant: this,\n        enabled: this.isAudioEnabled,\n      });\n    } catch (error) {\n      this.emit(\"error\", {\n        participant: this,\n        error,\n        action: \"toggleMicrophone\",\n      });\n    }\n  }\n\n  /**\n   * Toggle camera (local only)\n   */\n  async toggleCamera() {\n    if (!this.isLocal || !this.publisher) return;\n\n    try {\n      await this.publisher.toggleCamera();\n      this.isVideoEnabled = !this.isVideoEnabled;\n      this._updateCamButton();\n      this.emit(\"videoToggled\", {\n        participant: this,\n        enabled: this.isVideoEnabled,\n      });\n    } catch (error) {\n      this.emit(\"error\", { participant: this, error, action: \"toggleCamera\" });\n    }\n  }\n\n  /**\n   * Toggle remote participant's audio\n   */\n  async toggleRemoteAudio() {\n    if (this.isLocal || !this.subscriber) return;\n\n    try {\n      await this.subscriber.toggleAudio();\n      this.isAudioEnabled = !this.isAudioEnabled;\n      this._updateRemoteAudioButton();\n      this.emit(\"remoteAudioToggled\", {\n        participant: this,\n        enabled: this.isAudioEnabled,\n      });\n    } catch (error) {\n      this.emit(\"error\", {\n        participant: this,\n        error,\n        action: \"toggleRemoteAudio\",\n      });\n    }\n  }\n\n  /**\n   * Toggle pin status\n   */\n  togglePin() {\n    this.isPinned = !this.isPinned;\n    this.emit(\"pinToggled\", { participant: this, pinned: this.isPinned });\n  }\n\n  /**\n   * Update microphone button appearance\n   */\n  _updateMicButton() {\n    const micBtn = this.tile?.querySelector(`#micBtn-${this.streamId}`);\n    if (!micBtn) return;\n\n    micBtn.classList.toggle(\"muted\", !this.isAudioEnabled);\n    micBtn.title = this.isAudioEnabled\n      ? \"Mute microphone\"\n      : \"Unmute microphone\";\n\n    if (!this.isAudioEnabled) {\n      micBtn.innerHTML = `\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28z\"/>\n          <path d=\"M14.98 11.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99z\"/>\n          <path d=\"M4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c.57-.08 1.12-.23 1.64-.46l2.36 2.36L21 19.73 4.27 3z\"/>\n        </svg>\n      `;\n    } else {\n      micBtn.innerHTML = `\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"/>\n          <path d=\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z\"/>\n        </svg>\n      `;\n    }\n  }\n\n  /**\n   * Update camera button appearance\n   */\n  _updateCamButton() {\n    const camBtn = this.tile?.querySelector(`#camBtn-${this.streamId}`);\n    if (!camBtn) return;\n\n    camBtn.classList.toggle(\"disabled\", !this.isVideoEnabled);\n    camBtn.title = this.isVideoEnabled ? \"Turn off camera\" : \"Turn on camera\";\n\n    if (!this.isVideoEnabled) {\n      camBtn.innerHTML = `\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5z\"/>\n          <path d=\"M3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n        </svg>\n      `;\n    } else {\n      camBtn.innerHTML = `\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n        </svg>\n      `;\n    }\n  }\n\n  /**\n   * Update remote audio button appearance\n   */\n  _updateRemoteAudioButton() {\n    const audioBtn = this.tile?.querySelector(`#audioBtn-${this.streamId}`);\n    if (!audioBtn) return;\n\n    audioBtn.classList.toggle(\"muted\", !this.isAudioEnabled);\n    audioBtn.title = this.isAudioEnabled ? \"Mute audio\" : \"Unmute audio\";\n\n    if (!this.isAudioEnabled) {\n      audioBtn.innerHTML = `\n        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63z\"/>\n          <path d=\"M19 12c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71z\"/>\n          <path d=\"M4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3z\"/>\n          <path d=\"M12 4L9.91 6.09 12 8.18V4z\"/>\n        </svg>\n      `;\n    } else {\n      audioBtn.innerHTML = `\n        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/>\n        </svg>\n      `;\n    }\n  }\n\n  /**\n   * Update connection status\n   */\n  setConnectionStatus(status) {\n    this.connectionStatus = status;\n    this.emit(\"statusChanged\", { participant: this, status });\n\n    if (this.tile) {\n      const statusDiv = this.tile.querySelector(\".status\");\n      if (statusDiv) {\n        statusDiv.textContent = this._getStatusText(status);\n        statusDiv.className = `status ${status}`;\n      }\n    }\n  }\n\n  /**\n   * Get status text for display\n   */\n  _getStatusText(status) {\n    switch (status) {\n      case \"connecting\":\n        return \"Connecting...\";\n      case \"connected\":\n        return \"Connected\";\n      case \"disconnected\":\n        return \"Disconnected\";\n      case \"failed\":\n        return \"Connection Failed\";\n      default:\n        return status;\n    }\n  }\n\n  /**\n   * Set publisher instance\n   */\n  setPublisher(publisher) {\n    this.publisher = publisher;\n    if (publisher) {\n      this.setConnectionStatus(\"connected\");\n    }\n  }\n\n  /**\n   * Set subscriber instance\n   */\n  setSubscriber(subscriber) {\n    this.subscriber = subscriber;\n    if (subscriber) {\n      this.setConnectionStatus(\"connected\");\n    }\n  }\n\n  /**\n   * Cleanup participant resources\n   */\n  cleanup() {\n    // Stop media streams\n    if (this.publisher) {\n      this.publisher.stop();\n      this.publisher = null;\n    }\n\n    if (this.subscriber) {\n      this.subscriber.stop();\n      this.subscriber = null;\n    }\n\n    // Remove DOM elements\n    if (this.tile && this.tile.parentNode) {\n      this.tile.parentNode.removeChild(this.tile);\n    }\n\n    this.videoElement = null;\n    this.tile = null;\n\n    this.setConnectionStatus(\"disconnected\");\n    this.removeAllListeners();\n\n    this.emit(\"cleanup\", { participant: this });\n  }\n\n  /**\n   * Get participant info\n   */\n  getInfo() {\n    return {\n      userId: this.userId,\n      streamId: this.streamId,\n      membershipId: this.membershipId,\n      role: this.role,\n      isLocal: this.isLocal,\n      isAudioEnabled: this.isAudioEnabled,\n      isVideoEnabled: this.isVideoEnabled,\n      isPinned: this.isPinned,\n      connectionStatus: this.connectionStatus,\n    };\n  }\n}\n\nexport default Participant;\n","/**\n * WebRTC Publisher Class\n * Handles video/audio streaming via WebTransport\n */\nexport default class Publisher {\n  constructor(options = {}) {\n    // Validate required options\n    if (!options.publishUrl) {\n      throw new Error(\"publishUrl is required\");\n    }\n    if (!options.videoElement) {\n      throw new Error(\"videoElement is required\");\n    }\n\n    // Configuration\n    this.publishUrl = options.publishUrl;\n    this.streamType = options.streamType || \"camera\"; // 'camera' or 'display'\n    this.videoElement = options.videoElement;\n    this.streamId = options.streamId || \"test_stream\";\n\n    // Video configuration\n    this.currentConfig = {\n      // codec: \"hev1.1.0.L90.b0\",\n      codec: \"avc1.640c34\",\n      // codec: \"avc1.42E01E\",\n      width: options.width || 1280,\n      height: options.height || 720,\n      framerate: options.framerate || 30,\n      bitrate: options.bitrate || 1_500_000,\n    };\n\n    // Audio configuration\n    this.kSampleRate = 48000;\n    this.opusBaseTime = 0;\n    this.opusSamplesSent = 0;\n    this.opusSamplesPerChunk = 960; // 20ms at 48kHz\n    this.opusChunkCount = 0;\n\n    // State variables\n    this.stream = null;\n    this.audioProcessor = null;\n    this.videoProcessor = null;\n    this.webTransport = null;\n    this.webtransportWriter = null;\n    this.webtransportReader = null;\n    this.isChannelOpen = false;\n    this.mediaConfigSent = false;\n    this.videoMetadataReady = false;\n    this.audioConfig = null;\n    this.videoConfig = null;\n    this.videoDescription = null;\n    this.sequenceNumber = 0;\n    this.isPublishing = false;\n\n    this.cameraEnabled = true;\n    this.micEnabled = true;\n\n    // Callbacks\n    this.onStatusUpdate =\n      options.onStatusUpdate || ((message, isError) => console.log(message));\n    this.onStreamStart = options.onStreamStart || (() => {});\n    this.onStreamStop = options.onStreamStop || (() => {});\n\n    // Initialize modules\n    this.wasmInitialized = false;\n    this.wasmInitializing = false;\n    this.wasmInitPromise = null;\n    this.initAudioRecorder = null;\n    this.WasmEncoder = null;\n\n    this.onServerEvent = options.onServerEvent || ((event) => {});\n\n    // Video encoder\n    this.videoEncoder = new VideoEncoder({\n      output: this.handleVideoChunk.bind(this),\n      error: (e) => this.onStatusUpdate(`Encoder error: ${e.message}`, true),\n    });\n  }\n\n  async init() {\n    await this.loadAllDependencies();\n    this.onStatusUpdate(\"Publisher initialized successfully\");\n  }\n\n  async loadAllDependencies() {\n    try {\n      if (\n        !document.querySelector('script[src=\"../polyfills/MSTP_polyfill.js\"]')\n      ) {\n        await new Promise((resolve, reject) => {\n          const script = document.createElement(\"script\");\n          script.src = \"../polyfills/MSTP_polyfill.js\";\n          script.onload = () => resolve();\n          script.onerror = () =>\n            reject(new Error(\"Failed to load MSTP polyfill\"));\n          document.head.appendChild(script);\n        });\n        console.log(\"Polyfill loaded successfully\");\n      }\n\n      if (!this.wasmInitialized) {\n        if (this.wasmInitializing && this.wasmInitPromise) {\n          await this.wasmInitPromise;\n        } else {\n          this.wasmInitializing = true;\n          const { default: init, WasmEncoder } = await import(\n            \"../raptorQ/raptorq_wasm.js\"\n          );\n\n          this.WasmEncoder = WasmEncoder;\n\n          this.wasmInitPromise = init(\"../raptorQ/raptorq_wasm_bg.wasm\")\n            .then(() => {\n              this.wasmInitialized = true;\n              this.wasmInitializing = false;\n              console.log(\"WASM encoder module loaded successfully\");\n            })\n            .catch((err) => {\n              this.wasmInitializing = false;\n              console.error(\"Failed to load WASM encoder module:\", err);\n              throw new Error(\"Failed to load WASM encoder module\");\n            });\n\n          await this.wasmInitPromise;\n        }\n      }\n\n      const opusModule = await import(\n        `/opus_decoder/opusDecoder.js?t=${Date.now()}`\n      );\n      this.initAudioRecorder = opusModule.initAudioRecorder;\n      console.log(\"Opus decoder module loaded successfully\");\n\n      this.onStatusUpdate(\"All dependencies loaded successfully\");\n    } catch (error) {\n      this.onStatusUpdate(`Dependency loading error: ${error.message}`, true);\n      throw error;\n    }\n  }\n\n  async startPublishing() {\n    if (this.isPublishing) {\n      this.onStatusUpdate(\"Already publishing\", true);\n      return;\n    }\n    await this.init();\n\n    // Setup WebTransport connection\n    await this.setupConnection();\n\n    try {\n      // Get media stream based on type\n      await this.getMediaStream();\n      this.isPublishing = true;\n      // Start streaming\n      await this.startStreaming();\n\n      this.onStreamStart();\n      this.onStatusUpdate(\"Publishing started successfully\");\n    } catch (error) {\n      this.onStatusUpdate(`Failed to start publishing: ${error.message}`, true);\n      throw error;\n    }\n  }\n\n  // Toggle camera\n  toggleCamera() {\n    if (this.cameraEnabled) {\n      this.turnOffCamera();\n    } else {\n      this.turnOnCamera();\n    }\n  }\n\n  // Toggle mic\n  toggleMic() {\n    if (this.micEnabled) {\n      this.turnOffMic();\n    } else {\n      this.turnOnMic();\n    }\n  }\n\n  // Turn off camera (stop encoding video frames)\n  turnOffCamera() {\n    this.cameraEnabled = false;\n    this.videoElement && (this.videoElement.srcObject = null);\n    this.onStatusUpdate(\"Camera turned off\");\n  }\n\n  // Turn on camera (resume encoding video frames)\n  turnOnCamera() {\n    this.cameraEnabled = true;\n    if (\n      this.stream &&\n      this.stream.getVideoTracks().length > 0 &&\n      this.videoElement\n    ) {\n      const videoOnlyStream = new MediaStream();\n      videoOnlyStream.addTrack(this.stream.getVideoTracks()[0]);\n      this.videoElement.srcObject = videoOnlyStream;\n    }\n    this.onStatusUpdate(\"Camera turned on\");\n  }\n\n  // Turn off mic (stop encoding audio chunks)\n  turnOffMic() {\n    this.micEnabled = false;\n    this.onStatusUpdate(\"Mic turned off\");\n  }\n\n  // Turn on mic (resume encoding audio chunks)\n  turnOnMic() {\n    this.micEnabled = true;\n    this.onStatusUpdate(\"Mic turned on\");\n  }\n\n  async getMediaStream() {\n    if (this.streamType === \"camera\") {\n      const constraints = {\n        audio: {\n          sampleRate: this.kSampleRate,\n          channelCount: 1,\n          echoCancellation: true,\n          noiseSuppression: true,\n        },\n        video: {\n          width: { ideal: this.currentConfig.width },\n          height: { ideal: this.currentConfig.height },\n          frameRate: { ideal: this.currentConfig.framerate },\n        },\n      };\n      try {\n        this.stream = await navigator.mediaDevices.getUserMedia(constraints);\n      } catch (error) {\n        console.error(\"Error accessing media devices:\", error);\n      }\n    } else if (this.streamType === \"display\") {\n      this.stream = await navigator.mediaDevices.getDisplayMedia({\n        video: true,\n        audio: true,\n      });\n\n      // Handle user stopping screen share via browser UI\n      const videoTrack = this.stream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.onended = () => {\n          this.stop();\n        };\n      }\n    }\n\n    const videoOnlyStream = new MediaStream();\n    const videoTracks = this.stream.getVideoTracks();\n\n    if (videoTracks.length > 0) {\n      videoOnlyStream.addTrack(videoTracks[0]);\n    }\n\n    this.videoElement.srcObject = videoOnlyStream;\n\n    // this.videoElement.srcObject = this.stream;\n    this.onStatusUpdate(`${this.streamType} stream obtained`);\n  }\n\n  async setupConnection() {\n    this.webTransport = new WebTransport(this.publishUrl);\n    await this.webTransport.ready;\n    console.log(\"WebTransport connected to server\");\n\n    const stream = await this.webTransport.createBidirectionalStream();\n    const readable = stream.readable;\n    const writable = stream.writable;\n\n    this.webtransportWriter = writable.getWriter();\n    this.webtransportReader = readable.getReader();\n    console.log(\"WebTransport bidirectional stream established\");\n    this.onStatusUpdate(\"WebTransport connection established\");\n\n    setInterval(() => {\n      const ping = new TextEncoder().encode(\"ping\");\n      if (this.isChannelOpen && this.webtransportWriter) {\n        this.sendOverWebTransportStream(ping);\n      }\n    }, 500);\n\n    (async () => {\n      try {\n        while (true) {\n          const { value, done } = await this.webtransportReader.read();\n          if (done) {\n            console.log(\"ðŸ”Œ Bi-directional stream closed by server\");\n            break;\n          }\n          if (value) {\n            const msg = new TextDecoder().decode(value);\n            if (msg === \"pong\") {\n              continue; // Ignore pong responses\n            }\n            let msgJson;\n            try {\n              msgJson = JSON.parse(msg);\n              console.log(\"ðŸ“© Message from server:\", msgJson);\n            } catch (e) {\n              msgJson = null;\n            }\n            if (msgJson) {\n              console.log(\"Emitting server event:\", msgJson);\n              this.onServerEvent(msgJson);\n            }\n          }\n        }\n      } catch (err) {\n        console.error(\"âŒ Error reading from bidi stream:\", err);\n      }\n    })();\n    this.isChannelOpen = true;\n  }\n\n  async startStreaming() {\n    // Start video capture\n    await this.startVideoCapture();\n\n    // Start audio streaming\n    this.audioProcessor = await this.startOpusAudioStreaming();\n  }\n\n  async startVideoCapture() {\n    if (!this.stream) {\n      throw new Error(\"No media stream available\");\n    }\n\n    const triggerWorker = new Worker(\"polyfills/triggerWorker.js\");\n    triggerWorker.postMessage({ frameRate: this.currentConfig.framerate });\n\n    const track = this.stream.getVideoTracks()[0];\n    this.videoProcessor = new MediaStreamTrackProcessor(\n      track,\n      triggerWorker,\n      true\n    );\n    const reader = this.videoProcessor.readable.getReader();\n\n    // Configure video encoder\n    this.videoEncoder.configure({\n      codec: this.currentConfig.codec,\n      width: this.currentConfig.width,\n      height: this.currentConfig.height,\n      bitrate: this.currentConfig.bitrate,\n      framerate: this.currentConfig.framerate,\n      latencyMode: \"realtime\",\n      hardwareAcceleration: \"prefer-hardware\",\n      // hevc: { format: \"annexb\", maxBFrames: 0 },/\n    });\n\n    let frameCounter = 0;\n\n    // Process video frames\n    (async () => {\n      try {\n        while (this.isPublishing) {\n          const result = await reader.read();\n          if (result.done) break;\n\n          const frame = result.value;\n\n          if (!window.videoBaseTimestamp) {\n            window.videoBaseTimestamp = frame.timestamp;\n          }\n\n          if (!this.cameraEnabled) {\n            frame.close();\n            continue;\n          }\n\n          if (this.videoEncoder.encodeQueueSize > 2) {\n            frame.close();\n          } else {\n            frameCounter++;\n            const keyFrame = frameCounter % 30 === 0; // Key frame every ~1 seconds\n            this.videoEncoder.encode(frame, { keyFrame });\n            frame.close();\n          }\n        }\n      } catch (error) {\n        this.onStatusUpdate(`Video processing error: ${error.message}`, true);\n      }\n    })();\n  }\n\n  async startOpusAudioStreaming() {\n    if (!this.stream) {\n      throw new Error(\"No media stream available\");\n    }\n\n    const audioTrack = this.stream.getAudioTracks()[0];\n    if (!audioTrack) {\n      throw new Error(\"No audio track found in stream\");\n    }\n\n    const audioRecorderOptions = {\n      encoderApplication: 2051,\n      encoderComplexity: 0,\n      encoderFrameSize: 20,\n      timeSlice: 100,\n    };\n\n    const audioRecorder = await this.initAudioRecorder(\n      audioTrack,\n      audioRecorderOptions\n    );\n    audioRecorder.ondataavailable = this.handleOpusAudioChunk.bind(this);\n\n    await audioRecorder.start({\n      timeSlice: audioRecorderOptions.timeSlice,\n    });\n\n    return audioRecorder;\n  }\n\n  handleVideoChunk(chunk, metadata) {\n    if (metadata && metadata.decoderConfig && !this.videoMetadataReady) {\n      this.videoDescription = metadata.decoderConfig.description;\n      this.videoConfig = {\n        codec: metadata.decoderConfig.codec,\n        codedWidth: metadata.decoderConfig.codedWidth,\n        codedHeight: metadata.decoderConfig.codedHeight,\n        frameRate: this.currentConfig.framerate,\n        description: metadata.decoderConfig.description,\n      };\n      this.trySendMediaConfig();\n      this.videoMetadataReady = true;\n    }\n\n    const chunkData = new ArrayBuffer(chunk.byteLength);\n    chunk.copyTo(chunkData);\n    const type = chunk.type === \"key\" ? \"video-key\" : \"video-delta\";\n\n    if (!this.mediaConfigSent) {\n      return;\n    }\n\n    const packet = this.createPacketWithHeader(\n      chunkData,\n      chunk.timestamp,\n      type\n    );\n\n    this.sendOverWebTransportStream(packet);\n    this.sequenceNumber++;\n  }\n\n  handleOpusAudioChunk(typedArray) {\n    if (!this.micEnabled) return;\n\n    if (!this.isChannelOpen || !typedArray || typedArray.byteLength === 0)\n      return;\n\n    try {\n      const dataArray = new Uint8Array(typedArray);\n\n      // Check for OGG header signature\n      if (\n        dataArray.length >= 4 &&\n        dataArray[0] === 79 && // \"O\"\n        dataArray[1] === 103 && // \"g\"\n        dataArray[2] === 103 && // \"g\"\n        dataArray[3] === 83 // \"S\"\n      ) {\n        if (!this.audioConfig) {\n          const description = this.createPacketWithHeader(\n            dataArray,\n            performance.now() * 1000,\n            \"audio\"\n          );\n          this.audioConfig = {\n            codec: \"opus\",\n            sampleRate: 48000,\n            numberOfChannels: 1,\n            description,\n          };\n          this.trySendMediaConfig();\n        }\n\n        // Initialize base time on first chunk\n        if (this.opusBaseTime === 0 && window.videoBaseTimestamp) {\n          this.opusBaseTime = window.videoBaseTimestamp;\n          window.audioStartPerfTime = performance.now();\n          this.opusSamplesSent = 0;\n          this.opusChunkCount = 0;\n        } else if (this.opusBaseTime === 0 && !window.videoBaseTimestamp) {\n          this.opusBaseTime = performance.now() * 1000;\n          this.opusSamplesSent = 0;\n          this.opusChunkCount = 0;\n        }\n\n        const timestamp =\n          this.opusBaseTime +\n          Math.floor((this.opusSamplesSent * 1000000) / this.kSampleRate);\n\n        if (this.mediaConfigSent) {\n          const packet = this.createPacketWithHeader(\n            dataArray,\n            timestamp,\n            \"audio\"\n          );\n          this.sendOverWebTransportStream(packet);\n        }\n      }\n    } catch (error) {\n      console.error(\"Failed to send audio data:\", error);\n    }\n  }\n\n  async sendOverWebTransportStream(frameBytes) {\n    try {\n      const len = frameBytes.length;\n      const out = new Uint8Array(4 + len);\n      const view = new DataView(out.buffer);\n      view.setUint32(0, len, false); // big-endian\n      out.set(frameBytes, 4);\n      this.webtransportWriter.write(out);\n    } catch (error) {\n      this.webtransportWriter.close();\n      // console.error(\"Failed to send data over WebTransport stream:\", error);\n      return;\n      // this.webTransport.close();\n    }\n  }\n\n  createPacketWithHeader(data, timestamp, type) {\n    let adjustedTimestamp = timestamp;\n    if (window.videoBaseTimestamp) {\n      adjustedTimestamp = timestamp - window.videoBaseTimestamp;\n    }\n\n    let safeTimestamp = Math.floor(adjustedTimestamp / 1000);\n    if (safeTimestamp < 0) safeTimestamp = 0;\n\n    const HEADER_SIZE = 5;\n    const MAX_TS = 0xffffffff;\n    const MIN_TS = 0;\n\n    if (safeTimestamp > MAX_TS) safeTimestamp = MAX_TS;\n    if (safeTimestamp < MIN_TS) safeTimestamp = MIN_TS;\n\n    const packet = new Uint8Array(\n      HEADER_SIZE +\n        (data instanceof ArrayBuffer ? data.byteLength : data.length)\n    );\n\n    let frameType = 2;\n    if (type === \"video-key\") frameType = 0;\n    else if (type === \"video-delta\") frameType = 1;\n    else if (type === \"audio\") frameType = 2;\n    else if (type === \"config\") frameType = 3;\n    else frameType = 4; // unknown\n\n    packet[4] = frameType;\n\n    const view = new DataView(packet.buffer, 0, 4);\n    view.setUint32(0, safeTimestamp, false);\n\n    packet.set(\n      data instanceof ArrayBuffer ? new Uint8Array(data) : data,\n      HEADER_SIZE\n    );\n\n    return packet;\n  }\n\n  uint8ArrayToBase64(bytes) {\n    let binary = \"\";\n    const chunkSize = 0x8000; // ~32KB\n    for (let i = 0; i < bytes.length; i += chunkSize) {\n      const chunk = bytes.subarray(i, i + chunkSize);\n      binary += String.fromCharCode.apply(null, chunk);\n    }\n    return btoa(binary);\n  }\n\n  trySendMediaConfig() {\n    if (!this.mediaConfigSent && this.audioConfig && this.videoConfig) {\n      const aConfigBase64 = this.uint8ArrayToBase64(\n        new Uint8Array(this.audioConfig.description)\n      );\n      const vConfigUint8 = new Uint8Array(this.videoConfig.description);\n      const vConfigBase64 = this.uint8ArrayToBase64(vConfigUint8);\n\n      const config = {\n        type: \"DecoderConfigs\",\n        audioConfig: {\n          sampleRate: this.audioConfig.sampleRate,\n          numberOfChannels: this.audioConfig.numberOfChannels,\n          codec: this.audioConfig.codec,\n          description: aConfigBase64 || null,\n        },\n        videoConfig: {\n          codec: this.videoConfig.codec,\n          codedWidth: this.videoConfig.codedWidth,\n          codedHeight: this.videoConfig.codedHeight,\n          frameRate: this.videoConfig.frameRate,\n          description: vConfigBase64 || null,\n        },\n      };\n\n      const packet = new TextEncoder().encode(JSON.stringify(config));\n      this.sendOverWebTransportStream(packet);\n\n      this.mediaConfigSent = true;\n      this.onStatusUpdate(\"Media configuration sent\");\n    }\n  }\n\n  async stop() {\n    if (!this.isPublishing) {\n      return;\n    }\n\n    try {\n      this.isPublishing = false;\n\n      // Close encoders\n      if (this.videoEncoder && this.videoEncoder.state !== \"closed\") {\n        await this.videoEncoder.flush();\n        this.videoEncoder.close();\n      }\n\n      // Stop audio processor\n      if (\n        this.audioProcessor &&\n        typeof this.audioProcessor.stop === \"function\"\n      ) {\n        await this.audioProcessor.stop();\n        this.audioProcessor = null;\n      }\n\n      // Close WebTransport\n      if (this.webtransportWriter) {\n        await this.webtransportWriter.close();\n        this.webtransportWriter = null;\n      }\n\n      if (this.webTransport) {\n        this.webTransport.close();\n        this.webTransport = null;\n      }\n\n      // Stop all tracks\n      if (this.stream) {\n        this.stream.getTracks().forEach((track) => track.stop());\n        this.stream = null;\n      }\n\n      // Reset video element\n      this.videoElement.srcObject = null;\n\n      // Reset state\n      this.isChannelOpen = false;\n      this.mediaConfigSent = false;\n      this.videoMetadataReady = false;\n      this.audioConfig = null;\n      this.videoConfig = null;\n      this.sequenceNumber = 0;\n      this.opusBaseTime = 0;\n      this.opusSamplesSent = 0;\n      this.opusChunkCount = 0;\n\n      // Clear global variables\n      window.videoBaseTimestamp = null;\n      window.audioStartPerfTime = null;\n\n      this.onStreamStop();\n      this.onStatusUpdate(\"Publishing stopped\");\n    } catch (error) {\n      this.onStatusUpdate(`Error stopping publishing: ${error.message}`, true);\n      throw error;\n    }\n  }\n\n  // Getters for state\n  get isActive() {\n    return this.isPublishing;\n  }\n\n  get streamInfo() {\n    return {\n      streamType: this.streamType,\n      config: this.currentConfig,\n      sequenceNumber: this.sequenceNumber,\n      mediaConfigSent: this.mediaConfigSent,\n    };\n  }\n}\n","import EventEmitter from \"../events/EventEmitter.js\";\n\n/**\n * Enhanced Subscriber class for receiving media streams\n * Refactored from EnhancedSubscriber with better structure\n */\nclass Subscriber extends EventEmitter {\n  constructor(config) {\n    super();\n\n    // Configuration\n    this.streamId = config.streamId || \"\";\n    this.roomId = config.roomId || \"\";\n    this.host = config.host || \"stream-gate.bandia.vn\";\n    this.videoElement = config.videoElement;\n    this.isOwnStream = config.isOwnStream || false;\n\n    // Media configuration\n    this.mediaWorkerUrl = config.mediaWorkerUrl || \"workers/media-worker.js\";\n    this.audioWorkletUrl =\n      config.audioWorkletUrl || \"workers/audio-worklet1.js\";\n    this.mstgPolyfillUrl =\n      config.mstgPolyfillUrl || \"polyfills/MSTG_polyfill.js\";\n\n    // State\n    this.isStarted = false;\n    this.isAudioEnabled = true;\n    this.connectionStatus = \"disconnected\"; // 'disconnected', 'connecting', 'connected', 'failed'\n\n    // Media components\n    this.worker = null;\n    this.audioWorkletNode = null;\n    this.videoGenerator = null;\n    this.videoWriter = null;\n    this.mediaStream = null;\n\n    // Unique subscriber ID\n    this.subscriberId = `subscriber_${this.streamId}_${Date.now()}`;\n\n    // Audio mixer reference (will be set externally)\n    this.audioMixer = null;\n  }\n\n  /**\n   * Start the subscriber\n   */\n  async start() {\n    if (this.isStarted) {\n      throw new Error(\"Subscriber already started\");\n    }\n\n    try {\n      console.log(\"Starting subscriber:\", this.subscriberId);\n      this.emit(\"starting\", { subscriber: this });\n      this._updateConnectionStatus(\"connecting\");\n\n      const channel = new MessageChannel();\n\n      await this._loadPolyfill();\n      await this._initWorker(channel.port2);\n      await this._initAudioSystem(channel.port1);\n      this._initVideoSystem();\n\n      this.isStarted = true;\n      this._updateConnectionStatus(\"connected\");\n      this.emit(\"started\", { subscriber: this });\n    } catch (error) {\n      this._updateConnectionStatus(\"failed\");\n      this.emit(\"error\", { subscriber: this, error, action: \"start\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Stop the subscriber\n   */\n  stop() {\n    if (!this.isStarted) {\n      return;\n    }\n\n    try {\n      this.emit(\"stopping\", { subscriber: this });\n\n      // Remove from audio mixer\n      if (this.audioMixer) {\n        this.audioMixer.removeSubscriber(this.subscriberId);\n      }\n\n      // Terminate worker\n      if (this.worker) {\n        this.worker.terminate();\n        this.worker = null;\n      }\n\n      // Close video components\n      this._cleanupVideoSystem();\n\n      // Clear video element\n      if (this.videoElement) {\n        this.videoElement.srcObject = null;\n      }\n\n      // Clear references\n      this.audioWorkletNode = null;\n      this.mediaStream = null;\n\n      this.isStarted = false;\n      this._updateConnectionStatus(\"disconnected\");\n      this.emit(\"stopped\", { subscriber: this });\n    } catch (error) {\n      this.emit(\"error\", { subscriber: this, error, action: \"stop\" });\n    }\n  }\n\n  /**\n   * Toggle audio on/off\n   */\n  async toggleAudio() {\n    if (!this.isStarted || !this.worker) {\n      throw new Error(\"Subscriber not started\");\n    }\n\n    try {\n      this.worker.postMessage({ type: \"toggle-audio\" });\n      this.isAudioEnabled = !this.isAudioEnabled;\n\n      this.emit(\"audioToggled\", {\n        subscriber: this,\n        enabled: this.isAudioEnabled,\n      });\n\n      return this.isAudioEnabled;\n    } catch (error) {\n      this.emit(\"error\", { subscriber: this, error, action: \"toggleAudio\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Set audio mixer reference\n   */\n  setAudioMixer(audioMixer) {\n    this.audioMixer = audioMixer;\n  }\n\n  /**\n   * Get subscriber info\n   */\n  getInfo() {\n    return {\n      subscriberId: this.subscriberId,\n      streamId: this.streamId,\n      roomId: this.roomId,\n      host: this.host,\n      isOwnStream: this.isOwnStream,\n      isStarted: this.isStarted,\n      isAudioEnabled: this.isAudioEnabled,\n      connectionStatus: this.connectionStatus,\n    };\n  }\n\n  /**\n   * Load MediaStreamTrackGenerator polyfill if needed\n   */\n  async _loadPolyfill() {\n    if (!window.MediaStreamTrackGenerator) {\n      try {\n        await import(this.mstgPolyfillUrl);\n      } catch (error) {\n        console.warn(\"Failed to load MSTG polyfill:\", error);\n      }\n    }\n  }\n\n  /**\n   * Initialize media worker\n   */\n  async _initWorker(channelPort) {\n    try {\n      this.worker = new Worker(`${this.mediaWorkerUrl}?t=${Date.now()}`, {\n        type: \"module\",\n      });\n\n      this.worker.onmessage = (e) => this._handleWorkerMessage(e);\n      this.worker.onerror = (error) => {\n        this.emit(\"error\", {\n          subscriber: this,\n          error: new Error(`Media Worker error: ${error.message}`),\n          action: \"workerError\",\n        });\n      };\n\n      const mediaUrl = `wss://${this.host}/meeting/${this.roomId}/${this.streamId}`;\n      console.log(\"try to init worker with url:\", mediaUrl);\n\n      this.worker.postMessage(\n        {\n          type: \"init\",\n          data: { mediaUrl },\n          port: channelPort,\n        },\n        [channelPort]\n      );\n    } catch (error) {\n      throw new Error(`Worker initialization failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Initialize audio system with mixer\n   */\n  async _initAudioSystem(channelPort) {\n    try {\n      // Skip audio setup for own stream to prevent echo\n      if (this.isOwnStream) {\n        this.emit(\"audioSkipped\", {\n          subscriber: this,\n          reason: \"Own stream - preventing echo\",\n        });\n        return;\n      }\n\n      // Audio mixer should be set externally before starting\n      if (this.audioMixer) {\n        console.warn(\n          \"Adding subscriber to audio mixer in new subscriber:\",\n          this.subscriberId\n        );\n        this.audioWorkletNode = await this.audioMixer.addSubscriber(\n          this.subscriberId,\n          this.audioWorkletUrl,\n          this.isOwnStream,\n          channelPort\n        );\n\n        if (this.audioWorkletNode) {\n          this.audioWorkletNode.port.onmessage = (event) => {\n            const { type, bufferMs, isPlaying, newBufferSize } = event.data;\n            this.emit(\"audioStatus\", {\n              subscriber: this,\n              type,\n              bufferMs,\n              isPlaying,\n              newBufferSize,\n            });\n          };\n        }\n      }\n\n      this.emit(\"audioInitialized\", { subscriber: this });\n    } catch (error) {\n      throw new Error(`Audio system initialization failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Initialize video system\n   */\n  _initVideoSystem() {\n    try {\n      if (typeof MediaStreamTrackGenerator === \"function\") {\n        this.videoGenerator = new MediaStreamTrackGenerator({\n          kind: \"video\",\n        });\n      } else {\n        throw new Error(\n          \"MediaStreamTrackGenerator not supported in this browser\"\n        );\n      }\n\n      this.videoWriter = this.videoGenerator.writable;\n\n      // Create MediaStream with video track only\n      this.mediaStream = new MediaStream([this.videoGenerator]);\n\n      // Set video element source\n      if (this.videoElement) {\n        this.videoElement.srcObject = this.mediaStream;\n      }\n\n      this.emit(\"videoInitialized\", { subscriber: this });\n    } catch (error) {\n      throw new Error(`Video system initialization failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Cleanup video system\n   */\n  _cleanupVideoSystem() {\n    try {\n      // Close video writer\n      if (this.videoWriter) {\n        try {\n          const writer = this.videoWriter.getWriter();\n          writer.releaseLock();\n        } catch (e) {\n          // Writer might already be released\n        }\n        this.videoWriter = null;\n      }\n\n      // Stop video generator\n      if (this.videoGenerator) {\n        try {\n          if (this.videoGenerator.stop) {\n            this.videoGenerator.stop();\n          }\n        } catch (e) {\n          // Generator might already be stopped\n        }\n        this.videoGenerator = null;\n      }\n    } catch (error) {\n      console.warn(\"Error cleaning video system:\", error);\n    }\n  }\n\n  /**\n   * Handle messages from media worker\n   */\n  _handleWorkerMessage(e) {\n    const {\n      type,\n      frame,\n      message,\n      channelData,\n      sampleRate,\n      numberOfChannels,\n      timeStamp,\n      subscriberId,\n      audioEnabled,\n    } = e.data;\n\n    switch (type) {\n      case \"videoData\":\n        this._handleVideoData(frame);\n        break;\n\n      case \"status\":\n        this.emit(\"status\", { subscriber: this, message, isError: false });\n        break;\n\n      case \"error\":\n        this.emit(\"status\", { subscriber: this, message, isError: true });\n        this.emit(\"error\", {\n          subscriber: this,\n          error: new Error(message),\n          action: \"workerMessage\",\n        });\n        break;\n\n      case \"audio-toggled\":\n        this.emit(\"audioToggled\", {\n          subscriber: this,\n          enabled: audioEnabled,\n        });\n        break;\n\n      case \"skipping\":\n        this.emit(\"frameSkipped\", { subscriber: this });\n        break;\n\n      case \"resuming\":\n        this.emit(\"frameResumed\", { subscriber: this });\n        break;\n\n      default:\n        console.log(`Unknown worker message type: ${type}`, e.data);\n    }\n  }\n\n  /**\n   * Handle video data from worker\n   */\n  async _handleVideoData(frame) {\n    if (this.videoWriter && frame) {\n      try {\n        const writer = this.videoWriter.getWriter();\n        await writer.write(frame);\n        writer.releaseLock();\n\n        this.emit(\"videoFrameProcessed\", { subscriber: this });\n      } catch (error) {\n        this.emit(\"error\", {\n          subscriber: this,\n          error: new Error(`Video write error: ${error.message}`),\n          action: \"videoWrite\",\n        });\n      }\n    }\n  }\n\n  /**\n   * Update connection status\n   */\n  _updateConnectionStatus(status) {\n    if (this.connectionStatus === status) return;\n\n    const previousStatus = this.connectionStatus;\n    this.connectionStatus = status;\n\n    this.emit(\"connectionStatusChanged\", {\n      subscriber: this,\n      status,\n      previousStatus,\n    });\n  }\n}\n\nexport default Subscriber;\n","/**\n * AudioMixer Class for combining multiple subscriber audio streams\n * Provides centralized audio mixing and playback management\n */\nclass AudioMixer {\n  constructor(config = {}) {\n    this.audioContext = null;\n    this.mixerNode = null;\n    this.outputDestination = null;\n    this.subscriberNodes = new Map(); // subscriberId -> AudioWorkletNode\n    this.isInitialized = false;\n    this.outputAudioElement = null;\n\n    // Configuration\n    this.masterVolume = config.masterVolume || 0.8;\n    this.sampleRate = config.sampleRate || 48000;\n    this.bufferSize = config.bufferSize || 256;\n    this.enableEchoCancellation = config.enableEchoCancellation !== false;\n    this.debug = config.debug || false;\n  }\n\n  /**\n   * Initialize the audio mixer\n   */\n  async initialize() {\n    if (this.isInitialized) {\n      this._debug(\"AudioMixer already initialized\");\n      return;\n    }\n\n    try {\n      // Create shared AudioContext\n      this.audioContext = new (window.AudioContext ||\n        window.webkitAudioContext)({\n        sampleRate: this.sampleRate,\n        latencyHint: \"interactive\",\n      });\n\n      // Resume context if suspended (required by some browsers)\n      if (this.audioContext.state === \"suspended\") {\n        await this.audioContext.resume();\n      }\n\n      // Create mixer node (GainNode to combine audio)\n      this.mixerNode = this.audioContext.createGain();\n      this.mixerNode.gain.value = this.masterVolume;\n\n      // Create output destination\n      this.outputDestination = this.audioContext.createMediaStreamDestination();\n      this.mixerNode.connect(this.outputDestination);\n\n      // Create hidden audio element for mixed audio playback\n      this.outputAudioElement = document.createElement(\"audio\");\n      this.outputAudioElement.autoplay = true;\n      this.outputAudioElement.style.display = \"none\";\n      this.outputAudioElement.setAttribute(\"playsinline\", \"\");\n\n      // Disable echo cancellation on output element\n      if (this.enableEchoCancellation) {\n        this.outputAudioElement.setAttribute(\"webkitAudioContext\", \"true\");\n      }\n\n      document.body.appendChild(this.outputAudioElement);\n\n      this.isInitialized = true;\n      this._debug(\"AudioMixer initialized successfully\");\n\n      // Setup error handlers\n      this._setupErrorHandlers();\n    } catch (error) {\n      console.error(\"Failed to initialize AudioMixer:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Add a subscriber's audio stream to the mixer\n   */\n  async addSubscriber(\n    subscriberId,\n    audioWorkletUrl,\n    isOwnAudio = false,\n    channelWorkletPort\n  ) {\n    console.warn(`Adding subscriber ${subscriberId} to audio mixer`);\n    if (!this.isInitialized) {\n      await this.initialize();\n    }\n\n    // Skip adding own audio to prevent echo/feedback\n    if (isOwnAudio) {\n      this._debug(\n        `Skipping own audio for subscriber ${subscriberId} to prevent echo`\n      );\n      return null;\n    }\n\n    // Check if subscriber already exists\n    if (this.subscriberNodes.has(subscriberId)) {\n      this._debug(`Subscriber ${subscriberId} already exists in mixer`);\n      return this.subscriberNodes.get(subscriberId);\n    }\n\n    try {\n      // Load audio worklet if not already loaded\n      await this._loadAudioWorklet(audioWorkletUrl);\n\n      // Create AudioWorkletNode for this subscriber\n      const workletNode = new AudioWorkletNode(\n        this.audioContext,\n        \"jitter-resistant-processor\",\n        {\n          numberOfInputs: 0,\n          numberOfOutputs: 1,\n          outputChannelCount: [2],\n        }\n      );\n\n      // Connect the port if provided\n      if (channelWorkletPort) {\n        workletNode.port.postMessage(\n          { type: \"connectWorker\", port: channelWorkletPort },\n          [channelWorkletPort]\n        );\n      }\n\n      // Create gain node for individual volume control\n      const gainNode = this.audioContext.createGain();\n      gainNode.gain.value = 1.0;\n\n      // Connect: workletNode -> gainNode -> mixerNode\n      workletNode.connect(gainNode);\n      gainNode.connect(this.mixerNode);\n\n      // Store reference with gain node\n      this.subscriberNodes.set(subscriberId, {\n        workletNode,\n        gainNode,\n        isActive: true,\n        addedAt: Date.now(),\n      });\n\n      // Update audio element source with mixed stream\n      this._updateOutputAudio();\n\n      // Setup message handler\n      this._setupWorkletMessageHandler(subscriberId, workletNode);\n\n      this._debug(`Added subscriber ${subscriberId} to audio mixer`);\n      return workletNode;\n    } catch (error) {\n      console.error(\n        `Failed to add subscriber ${subscriberId} to mixer:`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  /**\n   * Remove a subscriber from the mixer\n   */\n  removeSubscriber(subscriberId) {\n    const subscriberData = this.subscriberNodes.get(subscriberId);\n    if (!subscriberData) {\n      this._debug(`Subscriber ${subscriberId} not found in mixer`);\n      return false;\n    }\n\n    try {\n      const { workletNode, gainNode } = subscriberData;\n\n      // Disconnect nodes\n      workletNode.disconnect();\n      gainNode.disconnect();\n\n      // Remove from map\n      this.subscriberNodes.delete(subscriberId);\n\n      // Update audio element if no more subscribers\n      this._updateOutputAudio();\n\n      this._debug(`Removed subscriber ${subscriberId} from audio mixer`);\n      return true;\n    } catch (error) {\n      console.error(`Failed to remove subscriber ${subscriberId}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * Set volume for a specific subscriber\n   */\n  setSubscriberVolume(subscriberId, volume) {\n    const subscriberData = this.subscriberNodes.get(subscriberId);\n    if (!subscriberData) {\n      this._debug(`Subscriber ${subscriberId} not found for volume adjustment`);\n      return false;\n    }\n\n    try {\n      const normalizedVolume = Math.max(0, Math.min(1, volume));\n      subscriberData.gainNode.gain.value = normalizedVolume;\n\n      this._debug(\n        `Set volume for subscriber ${subscriberId}: ${normalizedVolume}`\n      );\n      return true;\n    } catch (error) {\n      console.error(\n        `Failed to set volume for subscriber ${subscriberId}:`,\n        error\n      );\n      return false;\n    }\n  }\n\n  /**\n   * Mute/unmute a specific subscriber\n   */\n  setSubscriberMuted(subscriberId, muted) {\n    return this.setSubscriberVolume(subscriberId, muted ? 0 : 1);\n  }\n\n  /**\n   * Set master volume for all mixed audio\n   */\n  setMasterVolume(volume) {\n    if (!this.mixerNode) return false;\n\n    try {\n      const normalizedVolume = Math.max(0, Math.min(1, volume));\n      this.mixerNode.gain.value = normalizedVolume;\n      this.masterVolume = normalizedVolume;\n\n      this._debug(`Set master volume: ${normalizedVolume}`);\n      return true;\n    } catch (error) {\n      console.error(\"Failed to set master volume:\", error);\n      return false;\n    }\n  }\n\n  /**\n   * Get mixed audio output stream\n   */\n  getOutputMediaStream() {\n    if (!this.outputDestination) {\n      this._debug(\"Output destination not initialized\");\n      return null;\n    }\n    return this.outputDestination.stream;\n  }\n\n  /**\n   * Get current mixer statistics\n   */\n  getStats() {\n    return {\n      isInitialized: this.isInitialized,\n      subscriberCount: this.subscriberNodes.size,\n      masterVolume: this.masterVolume,\n      audioContextState: this.audioContext?.state || \"not-initialized\",\n      sampleRate: this.audioContext?.sampleRate || 0,\n      subscribers: Array.from(this.subscriberNodes.entries()).map(\n        ([id, data]) => ({\n          id,\n          volume: data.gainNode.gain.value,\n          isActive: data.isActive,\n          addedAt: data.addedAt,\n        })\n      ),\n    };\n  }\n\n  /**\n   * Get list of subscriber IDs\n   */\n  getSubscriberIds() {\n    return Array.from(this.subscriberNodes.keys());\n  }\n\n  /**\n   * Check if subscriber exists in mixer\n   */\n  hasSubscriber(subscriberId) {\n    return this.subscriberNodes.has(subscriberId);\n  }\n\n  /**\n   * Suspend audio context (for battery saving)\n   */\n  async suspend() {\n    if (this.audioContext && this.audioContext.state === \"running\") {\n      await this.audioContext.suspend();\n      this._debug(\"Audio context suspended\");\n    }\n  }\n\n  /**\n   * Resume audio context\n   */\n  async resume() {\n    if (this.audioContext && this.audioContext.state === \"suspended\") {\n      await this.audioContext.resume();\n      this._debug(\"Audio context resumed\");\n    }\n  }\n\n  /**\n   * Cleanup mixer resources\n   */\n  async cleanup() {\n    this._debug(\"Starting AudioMixer cleanup\");\n\n    try {\n      // Remove audio element\n      if (this.outputAudioElement) {\n        this.outputAudioElement.srcObject = null;\n        if (this.outputAudioElement.parentNode) {\n          this.outputAudioElement.parentNode.removeChild(\n            this.outputAudioElement\n          );\n        }\n        this.outputAudioElement = null;\n      }\n\n      // Disconnect all subscribers\n      for (const [subscriberId, subscriberData] of this.subscriberNodes) {\n        try {\n          const { workletNode, gainNode } = subscriberData;\n          workletNode.disconnect();\n          gainNode.disconnect();\n        } catch (error) {\n          console.error(\n            `Error disconnecting subscriber ${subscriberId}:`,\n            error\n          );\n        }\n      }\n      this.subscriberNodes.clear();\n\n      // Disconnect mixer components\n      if (this.mixerNode) {\n        this.mixerNode.disconnect();\n        this.mixerNode = null;\n      }\n\n      if (this.outputDestination) {\n        this.outputDestination = null;\n      }\n\n      // Close audio context\n      if (this.audioContext && this.audioContext.state !== \"closed\") {\n        await this.audioContext.close();\n      }\n\n      // Reset state\n      this.audioContext = null;\n      this.isInitialized = false;\n\n      this._debug(\"AudioMixer cleanup completed\");\n    } catch (error) {\n      console.error(\"Error during AudioMixer cleanup:\", error);\n    }\n  }\n\n  /**\n   * Load audio worklet module\n   */\n  async _loadAudioWorklet(audioWorkletUrl) {\n    console.warn(\"Loading audio worklet from:\", audioWorkletUrl);\n    try {\n      await this.audioContext.audioWorklet.addModule(audioWorkletUrl);\n      this._debug(\"Audio worklet loaded:\", audioWorkletUrl);\n    } catch (error) {\n      // Worklet might already be loaded\n      if (!error.message.includes(\"already been loaded\")) {\n        this._debug(\"Audio worklet load warning:\", error.message);\n      }\n    }\n  }\n\n  /**\n   * Update output audio element\n   */\n  _updateOutputAudio() {\n    if (!this.outputAudioElement || !this.outputDestination) return;\n\n    try {\n      if (this.subscriberNodes.size > 0) {\n        this.outputAudioElement.srcObject = this.outputDestination.stream;\n      } else {\n        this.outputAudioElement.srcObject = null;\n      }\n    } catch (error) {\n      console.error(\"Failed to update output audio:\", error);\n    }\n  }\n\n  /**\n   * Setup message handler for worklet node\n   */\n  _setupWorkletMessageHandler(subscriberId, workletNode) {\n    workletNode.port.onmessage = (event) => {\n      const { type, bufferMs, isPlaying, newBufferSize, error } = event.data;\n\n      switch (type) {\n        case \"bufferStatus\":\n          this._debug(\n            `Subscriber ${subscriberId} buffer: ${bufferMs}ms, playing: ${isPlaying}`\n          );\n          break;\n        case \"bufferSizeChanged\":\n          this._debug(\n            `Subscriber ${subscriberId} buffer size changed: ${newBufferSize}`\n          );\n          break;\n        case \"error\":\n          console.error(`Subscriber ${subscriberId} worklet error:`, error);\n          break;\n        default:\n          this._debug(\n            `Subscriber ${subscriberId} worklet message:`,\n            event.data\n          );\n      }\n    };\n\n    workletNode.port.onerror = (error) => {\n      console.error(`Subscriber ${subscriberId} worklet port error:`, error);\n    };\n  }\n\n  /**\n   * Setup error handlers for audio context\n   */\n  _setupErrorHandlers() {\n    if (!this.audioContext) return;\n\n    this.audioContext.onstatechange = () => {\n      this._debug(`Audio context state changed: ${this.audioContext.state}`);\n\n      if (this.audioContext.state === \"interrupted\") {\n        console.warn(\"Audio context was interrupted\");\n      }\n    };\n\n    // Listen for audio context suspend/resume events\n    document.addEventListener(\"visibilitychange\", async () => {\n      if (document.hidden) {\n        // Page hidden - optionally suspend context\n        // await this.suspend();\n      } else {\n        // Page visible - resume context if needed\n        await this.resume();\n      }\n    });\n  }\n\n  /**\n   * Debug logging\n   */\n  _debug(...args) {\n    if (this.debug) {\n      console.log(\"[AudioMixer]\", ...args);\n    }\n  }\n\n  /**\n   * Sleep utility for delays\n   */\n  _sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n\nexport default AudioMixer;\n","import EventEmitter from \"../events/EventEmitter.js\";\nimport Participant from \"./Participant.js\";\n\nimport Publisher from \"../media/Publisher.js\";\nimport Subscriber from \"../media/Subscriber.js\";\nimport AudioMixer from \"../media/AudioMixer.js\";\n\n/**\n * Represents a meeting room\n */\nclass Room extends EventEmitter {\n  constructor(config) {\n    super();\n\n    this.id = config.id;\n    this.name = config.name;\n    this.code = config.code;\n    this.type = config.type || \"main\"; // 'main', 'breakout'\n    this.parentRoomId = config.parentRoomId || null;\n    this.ownerId = config.ownerId;\n    this.isActive = false;\n\n    // Configuration\n    this.apiClient = config.apiClient;\n    this.mediaConfig = config.mediaConfig;\n\n    // Participants management\n    this.participants = new Map(); // userId -> Participant\n    this.localParticipant = null;\n\n    // Sub rooms (for main rooms only)\n    this.subRooms = new Map(); // subRoomId -> Room\n\n    // Media management\n    this.audioMixer = null;\n    this.pinnedParticipant = null;\n\n    // Connection info\n    this.membershipId = null;\n    this.streamId = null;\n\n    // UI containers\n    this.mainVideoArea = null;\n    this.sidebarArea = null;\n  }\n\n  /**\n   * Join this room\n   */\n  async join(userId) {\n    if (this.isActive) {\n      throw new Error(\"Already joined this room\");\n    }\n\n    try {\n      this.emit(\"joining\", { room: this });\n      console.log(\"Joining room with code\", this.code);\n      // Join via API\n      const joinResponse = await this.apiClient.joinRoom(this.code);\n\n      // Store connection info\n      this.id = joinResponse.room_id;\n      this.membershipId = joinResponse.id;\n      this.streamId = joinResponse.stream_id;\n\n      // Get room details and members\n      const roomDetails = await this.apiClient.getRoomById(\n        joinResponse.room_id\n      );\n      console.log(\"Joined room, details:\", roomDetails);\n\n      // Update room info\n      this._updateFromApiData(roomDetails.room);\n\n      // Setup participants\n      await this._setupParticipants(roomDetails.participants, userId);\n\n      if (this.mainVideoArea && this.sidebarArea) {\n        this.renderParticipantTiles();\n      }\n\n      // Setup media connections\n      await this._setupMediaConnections();\n\n      this.isActive = true;\n      this.emit(\"joined\", { room: this, participants: this.participants });\n\n      return {\n        room: this,\n        localParticipant: this.localParticipant,\n        participants: Array.from(this.participants.values()),\n      };\n    } catch (error) {\n      this.emit(\"error\", { room: this, error, action: \"join\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Leave this room\n   */\n  async leave() {\n    if (!this.isActive) {\n      return;\n    }\n\n    try {\n      this.emit(\"leaving\", { room: this });\n\n      // Cleanup media connections\n      await this._cleanupMediaConnections();\n\n      // Cleanup participants\n      this._cleanupParticipants();\n\n      // Leave via API\n      if (this.membershipId) {\n        await this.apiClient.leaveRoom(this.id, this.membershipId);\n      }\n\n      this.isActive = false;\n      this.emit(\"left\", { room: this });\n    } catch (error) {\n      this.emit(\"error\", { room: this, error, action: \"leave\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Create a sub room (main room only)\n   */\n  async createSubRoom(config) {\n    if (this.type !== \"main\") {\n      throw new Error(\"Only main rooms can create sub rooms\");\n    }\n\n    try {\n      this.emit(\"creatingSubRoom\", { room: this, config });\n\n      // Create sub room via API\n      const subRoomData = await this.apiClient.createSubRoom(\n        this.id,\n        config.name,\n        config.type || \"breakout\"\n      );\n\n      // Create sub room instance\n      const subRoom = new Room({\n        id: subRoomData.id,\n        name: subRoomData.room_name,\n        code: subRoomData.room_code,\n        type: config.type || \"breakout\",\n        parentRoomId: this.id,\n        ownerId: subRoomData.user_id,\n        apiClient: this.apiClient,\n        mediaConfig: this.mediaConfig,\n      });\n\n      // Store sub room\n      this.subRooms.set(subRoom.id, subRoom);\n\n      this.emit(\"subRoomCreated\", { room: this, subRoom });\n\n      return subRoom;\n    } catch (error) {\n      this.emit(\"error\", { room: this, error, action: \"createSubRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Get all sub rooms\n   */\n  async getSubRooms() {\n    if (this.type !== \"main\") {\n      return [];\n    }\n\n    try {\n      const subRoomsData = await this.apiClient.getSubRooms(this.id);\n\n      // Update local sub rooms map\n      for (const subRoomData of subRoomsData) {\n        if (!this.subRooms.has(subRoomData.id)) {\n          const subRoom = new Room({\n            id: subRoomData.id,\n            name: subRoomData.room_name,\n            code: subRoomData.room_code,\n            type: subRoomData.room_type,\n            parentRoomId: this.id,\n            ownerId: subRoomData.user_id,\n            apiClient: this.apiClient,\n            mediaConfig: this.mediaConfig,\n          });\n\n          this.subRooms.set(subRoom.id, subRoom);\n        }\n      }\n\n      return Array.from(this.subRooms.values());\n    } catch (error) {\n      this.emit(\"error\", { room: this, error, action: \"getSubRooms\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Switch to a sub room\n   */\n  async switchToSubRoom(subRoomCode) {\n    try {\n      this.emit(\"switchingToSubRoom\", { room: this, subRoomCode });\n\n      // Switch via API\n      const switchResponse = await this.apiClient.switchToSubRoom(\n        this.id,\n        subRoomCode\n      );\n\n      // Cleanup current media connections but keep participants\n      await this._cleanupMediaConnections();\n\n      // Update connection info for new sub room\n      this.membershipId = switchResponse.id;\n      this.streamId = switchResponse.stream_id;\n\n      // Setup media connections for sub room\n      await this._setupMediaConnections();\n\n      this.emit(\"switchedToSubRoom\", {\n        room: this,\n        subRoomCode,\n        response: switchResponse,\n      });\n\n      return switchResponse;\n    } catch (error) {\n      this.emit(\"error\", { room: this, error, action: \"switchToSubRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Return to main room from sub room\n   */\n  async returnToMainRoom() {\n    if (!this.parentRoomId) {\n      throw new Error(\"This is not a sub room\");\n    }\n\n    try {\n      this.emit(\"returningToMainRoom\", { room: this });\n\n      // Leave current sub room\n      await this.leave();\n\n      // The parent should handle rejoining main room\n      this.emit(\"returnedToMainRoom\", { room: this });\n    } catch (error) {\n      this.emit(\"error\", { room: this, error, action: \"returnToMainRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Add a participant to the room\n   */\n  addParticipant(memberData, userId) {\n    const isLocal = memberData.user_id === userId;\n\n    const participant = new Participant({\n      userId: memberData.user_id,\n      streamId: memberData.stream_id,\n      membershipId: memberData.id,\n      role: memberData.role,\n      roomId: this.id,\n      isLocal,\n    });\n\n    // Setup participant events\n    this._setupParticipantEvents(participant);\n\n    this.participants.set(participant.userId, participant);\n\n    if (isLocal) {\n      this.localParticipant = participant;\n    }\n\n    this.emit(\"participantAdded\", { room: this, participant });\n\n    return participant;\n  }\n\n  /**\n   * Remove a participant from the room\n   */\n  removeParticipant(userId) {\n    const participant = this.participants.get(userId);\n    if (!participant) return null;\n\n    // Cleanup participant\n    participant.cleanup();\n\n    // Remove from maps\n    this.participants.delete(userId);\n\n    if (this.localParticipant?.userId === userId) {\n      this.localParticipant = null;\n    }\n\n    if (this.pinnedParticipant?.userId === userId) {\n      this.pinnedParticipant = null;\n    }\n\n    this.emit(\"participantRemoved\", { room: this, participant });\n\n    return participant;\n  }\n\n  /**\n   * Get a participant by user ID\n   */\n  getParticipant(userId) {\n    return this.participants.get(userId);\n  }\n\n  /**\n   * Get all participants\n   */\n  getParticipants() {\n    return Array.from(this.participants.values());\n  }\n\n  /**\n   * Pin a participant's video\n   */\n  // pinParticipant(userId) {\n  //   const participant = this.participants.get(userId);\n  //   if (!participant) return false;\n\n  //   // Unpin current participant\n  //   if (this.pinnedParticipant) {\n  //     this.pinnedParticipant.isPinned = false;\n  //   }\n\n  //   // Pin new participant\n  //   participant.isPinned = true;\n  //   this.pinnedParticipant = participant;\n\n  //   this.emit(\"participantPinned\", { room: this, participant });\n\n  //   return true;\n  // }\n\n  pinParticipant(userId) {\n    const participant = this.participants.get(userId);\n    if (!participant) return false;\n\n    // Unpin current participant vÃ  move vá» sidebar\n    if (this.pinnedParticipant && this.pinnedParticipant !== participant) {\n      this.pinnedParticipant.isPinned = false;\n      this._moveParticipantTile(this.pinnedParticipant);\n    }\n\n    // Pin new participant vÃ  move lÃªn main\n    participant.isPinned = true;\n    this.pinnedParticipant = participant;\n    this._moveParticipantTile(participant);\n\n    this.emit(\"participantPinned\", { room: this, participant });\n\n    return true;\n  }\n\n  /**\n   * Unpin currently pinned participant\n   */\n  // unpinParticipant() {\n  //   if (!this.pinnedParticipant) return false;\n\n  //   this.pinnedParticipant.isPinned = false;\n  //   const unpinnedParticipant = this.pinnedParticipant;\n  //   this.pinnedParticipant = null;\n\n  //   this.emit(\"participantUnpinned\", {\n  //     room: this,\n  //     participant: unpinnedParticipant,\n  //   });\n\n  //   return true;\n  // }\n\n  unpinParticipant() {\n    if (!this.pinnedParticipant) return false;\n\n    this.pinnedParticipant.isPinned = false;\n    const unpinnedParticipant = this.pinnedParticipant;\n\n    // Move vá» sidebar\n    this._moveParticipantTile(unpinnedParticipant);\n\n    this.pinnedParticipant = null;\n\n    // Auto-pin local participant náº¿u cÃ³\n    if (this.localParticipant) {\n      this.pinParticipant(this.localParticipant.userId);\n    }\n\n    this.emit(\"participantUnpinned\", {\n      room: this,\n      participant: unpinnedParticipant,\n    });\n\n    return true;\n  }\n\n  /**\n   * Set UI containers for video tiles\n   */\n  setUIContainers(mainVideoArea, sidebarArea) {\n    this.mainVideoArea = mainVideoArea;\n    this.sidebarArea = sidebarArea;\n  }\n\n  /**\n   * Render participant video tiles\n   */\n\n  renderParticipantTiles() {\n    if (!this.mainVideoArea || !this.sidebarArea) {\n      throw new Error(\"UI containers not set\");\n    }\n\n    // Clear existing tiles\n    this.mainVideoArea.innerHTML = \"\";\n    this.sidebarArea.innerHTML = \"\";\n\n    console.warn(\n      \"Rendering participant tiles..., participants:\",\n      this.participants\n    );\n\n    // Render each participant's tile\n    for (const participant of this.participants.values()) {\n      // Táº¡o tile náº¿u chÆ°a cÃ³\n      let tile = participant.tile;\n      if (!tile) {\n        tile = participant.createVideoTile();\n      }\n\n      if (participant.isPinned) {\n        this.mainVideoArea.appendChild(tile);\n      } else {\n        this.sidebarArea.appendChild(tile);\n      }\n    }\n\n    // Auto-pin local participant if no one is pinned\n    if (!this.pinnedParticipant && this.localParticipant) {\n      this.pinParticipant(this.localParticipant.userId);\n      const localTile = this.localParticipant.tile;\n      if (localTile && !this.mainVideoArea.contains(localTile)) {\n        this.mainVideoArea.appendChild(localTile);\n      }\n    }\n  }\n\n  /**\n   * Get room info\n   */\n  getInfo() {\n    return {\n      id: this.id,\n      name: this.name,\n      code: this.code,\n      type: this.type,\n      parentRoomId: this.parentRoomId,\n      ownerId: this.ownerId,\n      isActive: this.isActive,\n      participantCount: this.participants.size,\n      subRoomCount: this.subRooms.size,\n      pinnedParticipant: this.pinnedParticipant?.userId || null,\n    };\n  }\n\n  /**\n   * Setup participants from API data\n   */\n  async _setupParticipants(participantsData, userId) {\n    for (const participantData of participantsData) {\n      this.addParticipant(participantData, userId);\n    }\n  }\n\n  /**\n   * Setup media connections for all participants\n   */\n  async _setupMediaConnections() {\n    // Initialize audio mixer\n    if (!this.audioMixer) {\n      this.audioMixer = new AudioMixer();\n      await this.audioMixer.initialize();\n    }\n\n    // Setup publisher for local participant\n    if (this.localParticipant) {\n      await this._setupLocalPublisher();\n    }\n\n    // Setup subscribers for remote participants\n    for (const participant of this.participants.values()) {\n      if (!participant.isLocal) {\n        await this._setupRemoteSubscriber(participant);\n      }\n    }\n  }\n\n  /**\n   * Setup publisher for local participant\n   */\n  async _setupLocalPublisher() {\n    if (!this.localParticipant || !this.streamId) return;\n\n    // this.localParticipant.createVideoTile();\n    if (!this.localParticipant.tile) {\n      const tile = this.localParticipant.createVideoTile();\n\n      // Append to main video area if set\n      if (this.mainVideoArea) {\n        this.mainVideoArea.innerHTML = \"\"; // Clear placeholder\n        this.mainVideoArea.appendChild(tile);\n      }\n    }\n\n    const videoElement = this.localParticipant.videoElement;\n    if (!videoElement) {\n      throw new Error(\"Video element not found for local participant\");\n    }\n\n    const publishUrl = `${this.mediaConfig.webtpUrl}/${this.id}/${this.streamId}`;\n    console.log(\"trying to connect webtransport to\", publishUrl);\n\n    const publisher = new Publisher({\n      publishUrl,\n      streamType: \"camera\",\n      videoElement: this.localParticipant.videoElement,\n      streamId: \"camera_stream\",\n      width: 1280,\n      height: 720,\n      framerate: 30,\n      bitrate: 1_500_000,\n      onStatusUpdate: (msg, isError) => {\n        this.localParticipant.setConnectionStatus(\n          isError ? \"failed\" : \"connected\"\n        );\n      },\n      onServerEvent: async (event) => {\n        await this._handleServerEvent(event);\n      },\n    });\n\n    await publisher.startPublishing();\n    this.localParticipant.setPublisher(publisher);\n  }\n\n  /**\n   * Setup subscriber for remote participant\n   */\n  async _setupRemoteSubscriber(participant) {\n    const subscriber = new Subscriber({\n      streamId: participant.streamId,\n      roomId: this.id,\n      host: this.mediaConfig.host,\n      videoElement: participant.videoElement,\n      onStatus: (msg, isError) => {\n        participant.setConnectionStatus(isError ? \"failed\" : \"connected\");\n      },\n      audioWorkletUrl: \"workers/audio-worklet1.js\",\n      mstgPolyfillUrl: \"polyfills/MSTG_polyfill.js\",\n    });\n    // Add to audio mixer\n    if (this.audioMixer) {\n      subscriber.setAudioMixer(this.audioMixer);\n    }\n\n    await subscriber.start();\n    participant.setSubscriber(subscriber);\n  }\n\n  /**\n   * Handle server events from publisher\n   */\n  async _handleServerEvent(event) {\n    console.log(\"Received server event:\", event);\n    // if (event.type === \"join\") {\n    //   const joinedParticipant = event.participant;\n    //   if (joinedParticipant.user_id === this.localParticipant?.userId) return;\n\n    //   const participant = this.addParticipant(\n    //     {\n    //       user_id: joinedParticipant.user_id,\n    //       stream_id: joinedParticipant.stream_id,\n    //       id: joinedParticipant.membership_id,\n    //       role: joinedParticipant.role,\n    //     },\n    //     this.localParticipant?.userId\n    //   );\n\n    //   this.renderParticipantTiles();\n    //   await this._setupRemoteSubscriber(participant);\n    // }\n\n    // if (event.type === \"leave\") {\n    //   this.removeParticipant(event.participant.user_id);\n    //   this.renderParticipantTiles();\n    // }\n    if (event.type === \"join\") {\n      const joinedParticipant = event.participant;\n      if (joinedParticipant.user_id === this.localParticipant?.userId) return;\n\n      const participant = this.addParticipant(\n        {\n          user_id: joinedParticipant.user_id,\n          stream_id: joinedParticipant.stream_id,\n          id: joinedParticipant.membership_id,\n          role: joinedParticipant.role,\n        },\n        this.localParticipant?.userId\n      );\n\n      // Táº¡o tile vÃ  thÃªm vÃ o UI ngay\n      const tile = participant.createVideoTile();\n      if (this.sidebarArea) {\n        this.sidebarArea.appendChild(tile);\n      }\n\n      // Setup subscriber sau khi Ä‘Ã£ cÃ³ tile vÃ  videoElement\n      await this._setupRemoteSubscriber(participant);\n    }\n\n    if (event.type === \"leave\") {\n      const participant = this.participants.get(event.participant.user_id);\n      if (participant) {\n        // Remove tile khá»i DOM trÆ°á»›c\n        if (participant.tile && participant.tile.parentNode) {\n          participant.tile.parentNode.removeChild(participant.tile);\n        }\n\n        // Sau Ä‘Ã³ cleanup participant\n        this.removeParticipant(event.participant.user_id);\n\n        // Náº¿u ngÆ°á»i bá»‹ remove lÃ  pinned participant, auto-pin local\n        if (!this.pinnedParticipant && this.localParticipant) {\n          this.pinParticipant(this.localParticipant.userId);\n          if (this.localParticipant.tile && this.mainVideoArea) {\n            this.mainVideoArea.innerHTML = \"\";\n            this.mainVideoArea.appendChild(this.localParticipant.tile);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Setup event listeners for a participant\n   */\n  // _setupParticipantEvents(participant) {\n  //   participant.on(\"pinToggled\", ({ participant: p, pinned }) => {\n  //     if (pinned) {\n  //       this.pinParticipant(p.userId);\n  //     } else if (this.pinnedParticipant === p) {\n  //       this.unpinParticipant();\n  //     }\n  //     this.renderParticipantTiles();\n  //   });\n\n  //   participant.on(\"error\", ({ participant: p, error, action }) => {\n  //     this.emit(\"participantError\", {\n  //       room: this,\n  //       participant: p,\n  //       error,\n  //       action,\n  //     });\n  //   });\n  // }\n\n  _setupParticipantEvents(participant) {\n    participant.on(\"pinToggled\", ({ participant: p, pinned }) => {\n      if (pinned) {\n        this.pinParticipant(p.userId);\n      } else if (this.pinnedParticipant === p) {\n        this.unpinParticipant();\n      }\n\n      // Chá»‰ di chuyá»ƒn tile cá»§a participant nÃ y\n      this._moveParticipantTile(p);\n    });\n\n    participant.on(\"error\", ({ participant: p, error, action }) => {\n      this.emit(\"participantError\", {\n        room: this,\n        participant: p,\n        error,\n        action,\n      });\n    });\n  }\n\n  _moveParticipantTile(participant) {\n    if (!participant.tile) return;\n\n    // Remove khá»i vá»‹ trÃ­ hiá»‡n táº¡i\n    if (participant.tile.parentNode) {\n      participant.tile.parentNode.removeChild(participant.tile);\n    }\n\n    // ThÃªm vÃ o vá»‹ trÃ­ má»›i\n    if (participant.isPinned && this.mainVideoArea) {\n      this.mainVideoArea.innerHTML = \"\";\n      this.mainVideoArea.appendChild(participant.tile);\n    } else if (!participant.isPinned && this.sidebarArea) {\n      this.sidebarArea.appendChild(participant.tile);\n    }\n  }\n\n  /**\n   * Update room data from API response\n   */\n  _updateFromApiData(roomData) {\n    this.name = roomData.room_name || this.name;\n    this.ownerId = roomData.user_id || this.ownerId;\n  }\n\n  /**\n   * Cleanup media connections\n   */\n  async _cleanupMediaConnections() {\n    // Cleanup audio mixer\n    if (this.audioMixer) {\n      await this.audioMixer.cleanup();\n      this.audioMixer = null;\n    }\n\n    // Cleanup all participants' media\n    for (const participant of this.participants.values()) {\n      if (participant.publisher) {\n        participant.publisher.stop();\n        participant.publisher = null;\n      }\n      if (participant.subscriber) {\n        participant.subscriber.stop();\n        participant.subscriber = null;\n      }\n    }\n  }\n\n  /**\n   * Cleanup all participants\n   */\n  _cleanupParticipants() {\n    for (const participant of this.participants.values()) {\n      participant.cleanup();\n    }\n\n    this.participants.clear();\n    this.localParticipant = null;\n    this.pinnedParticipant = null;\n  }\n\n  /**\n   * Cleanup room resources\n   */\n  async cleanup() {\n    if (this.isActive) {\n      await this.leave();\n    }\n\n    // Cleanup sub rooms\n    for (const subRoom of this.subRooms.values()) {\n      await subRoom.cleanup();\n    }\n    this.subRooms.clear();\n\n    this.removeAllListeners();\n  }\n}\n\nexport default Room;\n","import Room from \"./Room.js\";\n\n/**\n * SubRoom extends Room with additional functionality for breakout rooms\n */\nclass SubRoom extends Room {\n  constructor(config) {\n    super({\n      ...config,\n      type: config.type || \"breakout\",\n    });\n\n    this.parentRoom = config.parentRoom; // Reference to parent Room instance\n    this.maxParticipants = config.maxParticipants || 10;\n    this.autoReturn = config.autoReturn || false; // Auto return to main room when empty\n    this.duration = config.duration || null; // Duration in minutes, null = unlimited\n    this.startTime = null;\n\n    // Sub room specific state\n    this.isTemporary = config.isTemporary || true;\n    this.allowSelfAssign = config.allowSelfAssign || true;\n\n    this._setupSubRoomEvents();\n  }\n\n  /**\n   * Join the sub room from main room\n   */\n  async joinFromMain(userId) {\n    if (!this.parentRoom) {\n      throw new Error(\"No parent room reference\");\n    }\n\n    try {\n      this.emit(\"joiningFromMain\", { subRoom: this, userId });\n\n      // Pause main room media without leaving\n      await this.parentRoom._pauseMediaConnections();\n\n      // Join this sub room\n      const joinResult = await this.join(userId);\n\n      // Start duration timer if set\n      if (this.duration && !this.startTime) {\n        this.startTime = Date.now();\n        this._startDurationTimer();\n      }\n\n      this.emit(\"joinedFromMain\", { subRoom: this, userId, joinResult });\n\n      return joinResult;\n    } catch (error) {\n      // Resume main room media on error\n      if (this.parentRoom) {\n        await this.parentRoom._resumeMediaConnections();\n      }\n\n      this.emit(\"error\", { subRoom: this, error, action: \"joinFromMain\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Return to main room\n   */\n  async returnToMainRoom() {\n    if (!this.parentRoom) {\n      throw new Error(\"No parent room reference\");\n    }\n\n    try {\n      this.emit(\"returningToMain\", { subRoom: this });\n\n      // Leave sub room\n      await this.leave();\n\n      // Resume main room media\n      await this.parentRoom._resumeMediaConnections();\n\n      this.emit(\"returnedToMain\", { subRoom: this });\n\n      // Check if should cleanup empty room\n      if (this.participants.size === 0 && this.autoReturn) {\n        await this.cleanup();\n      }\n\n      return this.parentRoom;\n    } catch (error) {\n      this.emit(\"error\", { subRoom: this, error, action: \"returnToMainRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Switch to another sub room directly\n   */\n  async switchToSubRoom(targetSubRoom) {\n    if (!this.parentRoom) {\n      throw new Error(\"No parent room reference\");\n    }\n\n    try {\n      this.emit(\"switchingToSubRoom\", {\n        fromSubRoom: this,\n        toSubRoom: targetSubRoom,\n      });\n\n      // Leave current sub room\n      await this.leave();\n\n      // Join target sub room\n      const joinResult = await targetSubRoom.joinFromMain(\n        this.localParticipant?.userId\n      );\n\n      this.emit(\"switchedToSubRoom\", {\n        fromSubRoom: this,\n        toSubRoom: targetSubRoom,\n      });\n\n      return joinResult;\n    } catch (error) {\n      this.emit(\"error\", { subRoom: this, error, action: \"switchToSubRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Invite participant to this sub room\n   */\n  async inviteParticipant(userId) {\n    try {\n      // Send invitation via API (implementation depends on API support)\n      const result = await this.apiClient.inviteToSubRoom(this.id, userId);\n\n      this.emit(\"participantInvited\", { subRoom: this, userId, result });\n\n      return result;\n    } catch (error) {\n      this.emit(\"error\", { subRoom: this, error, action: \"inviteParticipant\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Assign participant to this sub room (host action)\n   */\n  async assignParticipant(userId) {\n    try {\n      // Force assignment via API\n      const result = await this.apiClient.assignToSubRoom(this.id, userId);\n\n      this.emit(\"participantAssigned\", { subRoom: this, userId, result });\n\n      return result;\n    } catch (error) {\n      this.emit(\"error\", { subRoom: this, error, action: \"assignParticipant\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Broadcast message to all participants\n   */\n  async broadcastMessage(message, type = \"info\") {\n    try {\n      const result = await this.apiClient.broadcastToSubRoom(\n        this.id,\n        message,\n        type\n      );\n\n      this.emit(\"messageBroadcast\", { subRoom: this, message, type, result });\n\n      return result;\n    } catch (error) {\n      this.emit(\"error\", { subRoom: this, error, action: \"broadcastMessage\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Get remaining time in minutes\n   */\n  getRemainingTime() {\n    if (!this.duration || !this.startTime) {\n      return null;\n    }\n\n    const elapsed = (Date.now() - this.startTime) / (1000 * 60); // in minutes\n    const remaining = Math.max(0, this.duration - elapsed);\n\n    return Math.ceil(remaining);\n  }\n\n  /**\n   * Extend sub room duration\n   */\n  extendDuration(additionalMinutes) {\n    if (!this.duration) {\n      this.duration = additionalMinutes;\n      this.startTime = Date.now();\n    } else {\n      this.duration += additionalMinutes;\n    }\n\n    this.emit(\"durationExtended\", {\n      subRoom: this,\n      additionalMinutes,\n      newDuration: this.duration,\n    });\n\n    // Restart timer if needed\n    if (this.startTime) {\n      this._startDurationTimer();\n    }\n  }\n\n  /**\n   * Set participant limit\n   */\n  setMaxParticipants(limit) {\n    this.maxParticipants = limit;\n\n    this.emit(\"maxParticipantsChanged\", {\n      subRoom: this,\n      maxParticipants: limit,\n    });\n\n    // If over limit, may need to handle overflow\n    if (this.participants.size > limit) {\n      this.emit(\"participantLimitExceeded\", {\n        subRoom: this,\n        current: this.participants.size,\n        limit,\n      });\n    }\n  }\n\n  /**\n   * Check if sub room is full\n   */\n  isFull() {\n    return this.participants.size >= this.maxParticipants;\n  }\n\n  /**\n   * Check if sub room is empty\n   */\n  isEmpty() {\n    return this.participants.size === 0;\n  }\n\n  /**\n   * Check if sub room has expired\n   */\n  hasExpired() {\n    if (!this.duration || !this.startTime) {\n      return false;\n    }\n\n    const elapsed = (Date.now() - this.startTime) / (1000 * 60);\n    return elapsed >= this.duration;\n  }\n\n  /**\n   * Get sub room statistics\n   */\n  getStats() {\n    return {\n      ...this.getInfo(),\n      maxParticipants: this.maxParticipants,\n      duration: this.duration,\n      remainingTime: this.getRemainingTime(),\n      startTime: this.startTime,\n      isFull: this.isFull(),\n      isEmpty: this.isEmpty(),\n      hasExpired: this.hasExpired(),\n      isTemporary: this.isTemporary,\n      allowSelfAssign: this.allowSelfAssign,\n      autoReturn: this.autoReturn,\n    };\n  }\n\n  /**\n   * Setup sub room specific events\n   */\n  _setupSubRoomEvents() {\n    // Handle participant left\n    this.on(\"participantRemoved\", ({ room, participant }) => {\n      // Auto return to main room if empty and configured to do so\n      if (this.isEmpty() && this.autoReturn && this.parentRoom) {\n        setTimeout(() => {\n          if (this.isEmpty()) {\n            // Double check after delay\n            this.cleanup();\n          }\n        }, 5000); // 5 second delay\n      }\n    });\n\n    // Handle room expiry warnings\n    if (this.duration) {\n      // Warn 5 minutes before expiry\n      const warningTime = Math.max(1, this.duration - 5);\n      setTimeout(() => {\n        if (this.isActive && !this.hasExpired()) {\n          this.emit(\"expiryWarning\", { subRoom: this, remainingMinutes: 5 });\n        }\n      }, warningTime * 60 * 1000);\n    }\n  }\n\n  /**\n   * Start duration timer for automatic closure\n   */\n  _startDurationTimer() {\n    if (this._durationTimer) {\n      clearTimeout(this._durationTimer);\n    }\n\n    if (!this.duration) return;\n\n    const remainingMs = this.getRemainingTime() * 60 * 1000;\n\n    if (remainingMs <= 0) {\n      this._handleExpiry();\n      return;\n    }\n\n    this._durationTimer = setTimeout(() => {\n      this._handleExpiry();\n    }, remainingMs);\n  }\n\n  /**\n   * Handle sub room expiry\n   */\n  async _handleExpiry() {\n    this.emit(\"expired\", { subRoom: this });\n\n    // Notify all participants\n    await this.broadcastMessage(\n      \"Sub room session has expired. Returning to main room.\",\n      \"warning\"\n    );\n\n    // Return all participants to main room\n    const participants = Array.from(this.participants.values());\n    for (const participant of participants) {\n      if (participant.isLocal) {\n        await this.returnToMainRoom();\n      }\n    }\n\n    // Cleanup sub room\n    await this.cleanup();\n  }\n\n  /**\n   * Override cleanup to clear timers\n   */\n  async cleanup() {\n    // Clear duration timer\n    if (this._durationTimer) {\n      clearTimeout(this._durationTimer);\n      this._durationTimer = null;\n    }\n\n    // Remove from parent room's sub rooms map\n    if (this.parentRoom) {\n      this.parentRoom.subRooms.delete(this.id);\n    }\n\n    // Call parent cleanup\n    await super.cleanup();\n\n    this.emit(\"cleanedUp\", { subRoom: this });\n  }\n\n  /**\n   * Serialize sub room state for persistence or transfer\n   */\n  serialize() {\n    return {\n      ...this.getStats(),\n      participantIds: Array.from(this.participants.keys()),\n      parentRoomId: this.parentRoom?.id || this.parentRoomId,\n      createdAt: this.startTime || Date.now(),\n    };\n  }\n\n  /**\n   * Create sub room from serialized data\n   */\n  static fromSerializedData(data, parentRoom, apiClient, mediaConfig) {\n    return new SubRoom({\n      id: data.id,\n      name: data.name,\n      code: data.code,\n      type: data.type,\n      parentRoom,\n      parentRoomId: data.parentRoomId,\n      ownerId: data.ownerId,\n      maxParticipants: data.maxParticipants,\n      duration: data.duration,\n      autoReturn: data.autoReturn,\n      isTemporary: data.isTemporary,\n      allowSelfAssign: data.allowSelfAssign,\n      apiClient,\n      mediaConfig,\n    });\n  }\n}\n\nexport default SubRoom;\n","import EventEmitter from \"../events/EventEmitter.js\";\nimport ApiClient from \"../api/ApiClient.js\";\nimport Room from \"./Room.js\";\nimport SubRoom from \"./SubRoom.js\";\n\n/**\n * Main Ermis Classroom client\n */\nclass ErmisClient extends EventEmitter {\n  constructor(config = {}) {\n    super();\n\n    // Configuration\n    this.config = {\n      host: config.host || \"daibo.ermis.network:9999\",\n      apiUrl:\n        config.apiUrl ||\n        `https://${config.host || \"daibo.ermis.network:9999\"}/meeting`,\n      webtpUrl:\n        config.webtpUrl || \"https://daibo.ermis.network:4455/meeting/wt\",\n      autoSaveCredentials: config.autoSaveCredentials !== false,\n      reconnectAttempts: config.reconnectAttempts || 3,\n      reconnectDelay: config.reconnectDelay || 2000,\n      debug: config.debug || false,\n    };\n\n    // API client\n    this.apiClient = new ApiClient({\n      host: this.config.host,\n      apiUrl: this.config.apiUrl,\n    });\n\n    // State management\n    this.state = {\n      user: null,\n      isAuthenticated: false,\n      currentRoom: null,\n      rooms: new Map(), // roomId -> Room\n      connectionStatus: \"disconnected\", // 'disconnected', 'connecting', 'connected', 'failed'\n    };\n\n    // Storage interface (can be overridden for different environments)\n    this.storage = config.storage || {\n      getItem: (key) => localStorage?.getItem(key),\n      setItem: (key, value) => localStorage?.setItem(key, value),\n      removeItem: (key) => localStorage?.removeItem(key),\n    };\n\n    // Media configuration\n    this.mediaConfig = {\n      host: this.config.host,\n      webtpUrl: this.config.webtpUrl,\n      defaultVideoConfig: {\n        width: 1280,\n        height: 720,\n        framerate: 30,\n        bitrate: 1_500_000,\n      },\n      defaultAudioConfig: {\n        sampleRate: 48000,\n        channels: 2,\n      },\n    };\n\n    this._setupEventHandlers();\n    this._attemptAutoLogin();\n  }\n\n  /**\n   * Authenticate user\n   */\n  async authenticate(userId) {\n    if (this.state.isAuthenticated && this.state.user?.id === userId) {\n      return this.state.user;\n    }\n\n    try {\n      this.emit(\"authenticating\", { userId });\n      this._setConnectionStatus(\"connecting\");\n\n      // Validate email format if it looks like email\n      if (userId.includes(\"@\")) {\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(userId)) {\n          throw new Error(\"Invalid email format\");\n        }\n      }\n\n      // Get authentication token\n      const tokenResponse = await this.apiClient.getDummyToken(userId);\n      //   const tokenResponse = await this.apiClient.refreshToken(userId);\n\n      // Set authentication in API client\n      this.apiClient.setAuth(tokenResponse.access_token, userId);\n\n      // Update state\n      this.state.user = {\n        id: userId,\n        token: tokenResponse.access_token,\n        authenticatedAt: Date.now(),\n      };\n      this.state.isAuthenticated = true;\n\n      // Save credentials if enabled\n      if (this.config.autoSaveCredentials) {\n        this._saveCredentials();\n      }\n\n      this._setConnectionStatus(\"connected\");\n      this.emit(\"authenticated\", { user: this.state.user });\n\n      this._debug(\"User authenticated successfully:\", userId);\n\n      return this.state.user;\n    } catch (error) {\n      this._setConnectionStatus(\"failed\");\n      this.emit(\"authenticationFailed\", { userId, error });\n      this._debug(\"Authentication failed:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Logout user\n   */\n  async logout() {\n    if (!this.state.isAuthenticated) {\n      return;\n    }\n\n    try {\n      this.emit(\"loggingOut\", { user: this.state.user });\n\n      // Leave current room if any\n      if (this.state.currentRoom) {\n        await this.state.currentRoom.leave();\n      }\n\n      // Clear credentials\n      this._clearCredentials();\n\n      // Reset state\n      this.state.user = null;\n      this.state.isAuthenticated = false;\n      this.state.currentRoom = null;\n      this.state.rooms.clear();\n\n      this._setConnectionStatus(\"disconnected\");\n      this.emit(\"loggedOut\");\n\n      this._debug(\"User logged out successfully\");\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"logout\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new room\n   */\n  async createRoom(config) {\n    this._ensureAuthenticated();\n\n    try {\n      this.emit(\"creatingRoom\", { config });\n\n      const roomData = await this.apiClient.createRoom(\n        config.name,\n        config.type\n      );\n\n      const room = new Room({\n        id: roomData.id,\n        name: roomData.room_name,\n        code: roomData.room_code,\n        type: config.type || \"main\",\n        ownerId: roomData.user_id,\n        apiClient: this.apiClient,\n        mediaConfig: this.mediaConfig,\n      });\n\n      this._setupRoomEvents(room);\n      this.state.rooms.set(room.id, room);\n\n      this.emit(\"roomCreated\", { room });\n      this._debug(\"Room created:\", room.getInfo());\n\n      // Auto-join if specified\n      if (config.autoJoin !== false) {\n        await this.joinRoom(room.code);\n      }\n\n      return room;\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"createRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Join a room by code\n   */\n  async joinRoom(roomCode) {\n    this._ensureAuthenticated();\n\n    try {\n      this.emit(\"joiningRoom\", { roomCode });\n\n      // Leave current room if any\n      if (this.state.currentRoom) {\n        await this.state.currentRoom.leave();\n      }\n\n      // Try to find existing room instance first\n      let room = Array.from(this.state.rooms.values()).find(\n        (r) => r.code === roomCode\n      );\n\n      if (!room) {\n        // Create new room instance\n        room = new Room({\n          code: roomCode,\n          apiClient: this.apiClient,\n          mediaConfig: this.mediaConfig,\n        });\n\n        this._setupRoomEvents(room);\n      }\n\n      // Join the room\n      const joinResult = await room.join(this.state.user.id);\n\n      // Update state\n      this.state.currentRoom = room;\n      this.state.rooms.set(room.id, room);\n\n      this.emit(\"roomJoined\", { room, joinResult });\n      this._debug(\"Joined room:\", room.getInfo());\n\n      return joinResult;\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"joinRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Leave current room\n   */\n  async leaveRoom() {\n    if (!this.state.currentRoom) {\n      return;\n    }\n\n    try {\n      const room = this.state.currentRoom;\n      this.emit(\"leavingRoom\", { room });\n\n      await room.leave();\n\n      this.state.currentRoom = null;\n\n      this.emit(\"roomLeft\", { room });\n      this._debug(\"Left room:\", room.getInfo());\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"leaveRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Get available rooms\n   */\n  async getRooms(options = {}) {\n    this._ensureAuthenticated();\n\n    try {\n      const response = await this.apiClient.listRooms(\n        options.page || 1,\n        options.perPage || 20\n      );\n\n      this.emit(\"roomsLoaded\", { rooms: response.data || [] });\n\n      return response.data || [];\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"getRooms\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Get current room\n   */\n  getCurrentRoom() {\n    return this.state.currentRoom;\n  }\n\n  /**\n   * Get room by ID\n   */\n  getRoom(roomId) {\n    return this.state.rooms.get(roomId);\n  }\n\n  /**\n   * Create sub room in current room\n   */\n  async createSubRoom(config) {\n    if (!this.state.currentRoom) {\n      throw new Error(\"Must be in a main room to create sub rooms\");\n    }\n\n    if (this.state.currentRoom.type !== \"main\") {\n      throw new Error(\"Can only create sub rooms from main rooms\");\n    }\n\n    try {\n      this.emit(\"creatingSubRoom\", {\n        config,\n        parentRoom: this.state.currentRoom,\n      });\n\n      const subRoom = await this.state.currentRoom.createSubRoom(config);\n\n      this.emit(\"subRoomCreated\", {\n        subRoom,\n        parentRoom: this.state.currentRoom,\n      });\n      this._debug(\"Sub room created:\", subRoom.getInfo());\n\n      return subRoom;\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"createSubRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Join a sub room\n   */\n  async joinSubRoom(subRoomCode) {\n    if (!this.state.currentRoom) {\n      throw new Error(\"Must be in a main room to join sub rooms\");\n    }\n\n    try {\n      this.emit(\"joiningSubRoom\", {\n        subRoomCode,\n        parentRoom: this.state.currentRoom,\n      });\n\n      // Find sub room\n      const subRooms = await this.state.currentRoom.getSubRooms();\n      const subRoom = subRooms.find((sr) => sr.code === subRoomCode);\n\n      if (!subRoom) {\n        throw new Error(`Sub room with code ${subRoomCode} not found`);\n      }\n\n      // Join sub room\n      const joinResult = await subRoom.joinFromMain(this.state.user.id);\n\n      this.emit(\"subRoomJoined\", {\n        subRoom,\n        parentRoom: this.state.currentRoom,\n      });\n      this._debug(\"Joined sub room:\", subRoom.getInfo());\n\n      return joinResult;\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"joinSubRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Return to main room from sub room\n   */\n  async returnToMainRoom() {\n    if (!this.state.currentRoom || this.state.currentRoom.type !== \"breakout\") {\n      throw new Error(\"Must be in a sub room to return to main room\");\n    }\n\n    try {\n      this.emit(\"returningToMainRoom\", { subRoom: this.state.currentRoom });\n\n      const subRoom = this.state.currentRoom;\n      const mainRoom = await subRoom.returnToMainRoom();\n\n      this.state.currentRoom = mainRoom;\n\n      this.emit(\"returnedToMainRoom\", { mainRoom, previousSubRoom: subRoom });\n      this._debug(\"Returned to main room from sub room\");\n\n      return mainRoom;\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"returnToMainRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Switch between sub rooms\n   */\n  async switchSubRoom(targetSubRoomCode) {\n    if (!this.state.currentRoom || this.state.currentRoom.type !== \"breakout\") {\n      throw new Error(\"Must be in a sub room to switch to another sub room\");\n    }\n\n    try {\n      this.emit(\"switchingSubRoom\", {\n        fromSubRoom: this.state.currentRoom,\n        targetSubRoomCode,\n      });\n\n      const currentSubRoom = this.state.currentRoom;\n      const parentRoom = currentSubRoom.parentRoom;\n\n      // Find target sub room\n      const subRooms = await parentRoom.getSubRooms();\n      const targetSubRoom = subRooms.find(\n        (sr) => sr.code === targetSubRoomCode\n      );\n\n      if (!targetSubRoom) {\n        throw new Error(`Sub room with code ${targetSubRoomCode} not found`);\n      }\n\n      // Switch to target sub room\n      const joinResult = await currentSubRoom.switchToSubRoom(targetSubRoom);\n\n      this.state.currentRoom = targetSubRoom;\n\n      this.emit(\"subRoomSwitched\", {\n        fromSubRoom: currentSubRoom,\n        toSubRoom: targetSubRoom,\n      });\n      this._debug(\"Switched sub rooms:\", {\n        from: currentSubRoom.getInfo(),\n        to: targetSubRoom.getInfo(),\n      });\n\n      return joinResult;\n    } catch (error) {\n      this.emit(\"error\", { error, action: \"switchSubRoom\" });\n      throw error;\n    }\n  }\n\n  /**\n   * Set UI containers for video rendering\n   */\n  setUIContainers(mainVideoArea, sidebarArea) {\n    console.warn(\"[ErmisCLient] Setting UI containers:\", {\n      mainVideoArea,\n      sidebarArea,\n    });\n    this.mediaConfig.mainVideoArea = mainVideoArea;\n    this.mediaConfig.sidebarArea = sidebarArea;\n\n    // Apply to current room if any\n    if (this.state.currentRoom) {\n      console.log(\"Applying UI containers to current room\");\n      this.state.currentRoom.setUIContainers(mainVideoArea, sidebarArea);\n    }\n  }\n\n  /**\n   * Get client state\n   */\n  getState() {\n    return {\n      user: this.state.user,\n      isAuthenticated: this.state.isAuthenticated,\n      currentRoom: this.state.currentRoom?.getInfo() || null,\n      connectionStatus: this.state.connectionStatus,\n      roomCount: this.state.rooms.size,\n    };\n  }\n\n  /**\n   * Get client configuration\n   */\n  getConfig() {\n    return { ...this.config };\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(newConfig) {\n    this.config = { ...this.config, ...newConfig };\n\n    // Update API client if needed\n    if (newConfig.host || newConfig.apiUrl) {\n      this.apiClient = new ApiClient({\n        host: this.config.host,\n        apiUrl: this.config.apiUrl,\n      });\n\n      if (this.state.isAuthenticated) {\n        this.apiClient.setAuth(this.state.user.token, this.state.user.id);\n      }\n    }\n\n    this.emit(\"configUpdated\", { config: this.config });\n  }\n\n  /**\n   * Enable debug mode\n   */\n  enableDebug() {\n    this.config.debug = true;\n    this._debug(\"Debug mode enabled\");\n  }\n\n  /**\n   * Disable debug mode\n   */\n  disableDebug() {\n    this.config.debug = false;\n  }\n\n  /**\n   * Cleanup client resources\n   */\n  async cleanup() {\n    try {\n      // Leave current room\n      if (this.state.currentRoom) {\n        await this.state.currentRoom.leave();\n      }\n\n      // Cleanup all rooms\n      for (const room of this.state.rooms.values()) {\n        await room.cleanup();\n      }\n\n      // Clear state\n      this.state.rooms.clear();\n      this.state.currentRoom = null;\n\n      // Remove all listeners\n      this.removeAllListeners();\n\n      this._debug(\"Client cleanup completed\");\n    } catch (error) {\n      console.error(\"Error during cleanup:\", error);\n    }\n  }\n\n  /**\n   * Setup event handlers for rooms\n   */\n  _setupRoomEvents(room) {\n    // Forward room events to client\n    const eventsToForward = [\n      \"joined\",\n      \"left\",\n      \"participantAdded\",\n      \"participantRemoved\",\n      \"participantPinned\",\n      \"participantUnpinned\",\n      \"subRoomCreated\",\n      \"error\",\n    ];\n\n    eventsToForward.forEach((event) => {\n      room.on(event, (data) => {\n        this.emit(\n          `room${event.charAt(0).toUpperCase() + event.slice(1)}`,\n          data\n        );\n      });\n    });\n\n    // Set UI containers if available\n    if (this.mediaConfig.mainVideoArea && this.mediaConfig.sidebarArea) {\n      room.setUIContainers(\n        this.mediaConfig.mainVideoArea,\n        this.mediaConfig.sidebarArea\n      );\n    }\n  }\n\n  /**\n   * Setup initial event handlers\n   */\n  _setupEventHandlers() {\n    // Handle authentication token refresh\n    this.on(\"authenticated\", () => {\n      // Could implement token refresh logic here\n    });\n\n    // Handle connection status changes\n    this.on(\"connectionStatusChanged\", ({ status }) => {\n      if (status === \"failed\" && this.config.reconnectAttempts > 0) {\n        this._attemptReconnect();\n      }\n    });\n  }\n\n  /**\n   * Attempt automatic login with saved credentials\n   */\n  async _attemptAutoLogin() {\n    if (!this.config.autoSaveCredentials) {\n      return;\n    }\n\n    try {\n      const savedUserId = this.storage.getItem(\"ermis_user_id\");\n      const savedToken = this.storage.getItem(\"ermis_token\");\n\n      if (savedUserId && savedToken) {\n        this.apiClient.setAuth(savedToken, savedUserId);\n\n        // Verify token is still valid by making a test call\n        await this.apiClient.listRooms(1, 1);\n\n        this.state.user = {\n          id: savedUserId,\n          token: savedToken,\n          authenticatedAt: Date.now(),\n        };\n        this.state.isAuthenticated = true;\n        this._setConnectionStatus(\"connected\");\n\n        this.emit(\"autoLoginSuccess\", { userId: savedUserId });\n        this._debug(\"Auto-login successful:\", savedUserId);\n      }\n    } catch (error) {\n      // Token might be expired, clear saved credentials\n      this._clearCredentials();\n      this._debug(\"Auto-login failed:\", error.message);\n    }\n  }\n\n  /**\n   * Attempt to reconnect\n   */\n  async _attemptReconnect() {\n    let attempts = 0;\n\n    while (attempts < this.config.reconnectAttempts) {\n      try {\n        attempts++;\n        this._debug(\n          `Reconnection attempt ${attempts}/${this.config.reconnectAttempts}`\n        );\n\n        await new Promise((resolve) =>\n          setTimeout(resolve, this.config.reconnectDelay)\n        );\n\n        if (this.state.user) {\n          await this.authenticate(this.state.user.id);\n          this._debug(\"Reconnection successful\");\n          return;\n        }\n      } catch (error) {\n        this._debug(`Reconnection attempt ${attempts} failed:`, error.message);\n      }\n    }\n\n    this.emit(\"reconnectionFailed\");\n    this._debug(\"All reconnection attempts failed\");\n  }\n\n  /**\n   * Save user credentials\n   */\n  _saveCredentials() {\n    if (!this.state.user) return;\n\n    try {\n      this.storage.setItem(\"ermis_user_id\", this.state.user.id);\n      this.storage.setItem(\"ermis_token\", this.state.user.token);\n      this._debug(\"Credentials saved\");\n    } catch (error) {\n      this._debug(\"Failed to save credentials:\", error);\n    }\n  }\n\n  /**\n   * Clear saved credentials\n   */\n  _clearCredentials() {\n    try {\n      this.storage.removeItem(\"ermis_user_id\");\n      this.storage.removeItem(\"ermis_token\");\n      this._debug(\"Credentials cleared\");\n    } catch (error) {\n      this._debug(\"Failed to clear credentials:\", error);\n    }\n  }\n\n  /**\n   * Set connection status\n   */\n  _setConnectionStatus(status) {\n    if (this.state.connectionStatus !== status) {\n      this.state.connectionStatus = status;\n      this.emit(\"connectionStatusChanged\", { status });\n      this._debug(\"Connection status changed:\", status);\n    }\n  }\n\n  /**\n   * Ensure user is authenticated\n   */\n  _ensureAuthenticated() {\n    if (!this.state.isAuthenticated) {\n      throw new Error(\"User must be authenticated first\");\n    }\n  }\n\n  /**\n   * Debug logging\n   */\n  _debug(...args) {\n    if (this.config.debug) {\n      console.log(\"[ErmisClient]\", ...args);\n    }\n  }\n}\n\nexport default ErmisClient;\n","/**\n * Ermis Classroom SDK\n * Main entry point for the SDK\n */\n\nimport ErmisClient from \"./core/ErmisClient.js\";\nimport Room from \"./core/Room.js\";\nimport SubRoom from \"./core/SubRoom.js\";\nimport Participant from \"./core/Participant.js\";\nimport ApiClient from \"./api/ApiClient.js\";\nimport EventEmitter from \"./events/EventEmitter.js\";\n\n/**\n * SDK Version\n */\nexport const VERSION = \"1.0.0\";\n\n/**\n * Main SDK Class - Similar to LiveKit pattern\n */\nclass ErmisClassroom {\n  /**\n   * Create a new Ermis Classroom client\n   * @param {Object} config - Configuration options\n   * @returns {ErmisClient} - New client instance\n   */\n  static create(config = {}) {\n    return new ErmisClient(config);\n  }\n\n  /**\n   * Connect and authenticate user\n   * @param {string} serverUrl - Server URL\n   * @param {string} userId - User identifier\n   * @param {Object} options - Connection options\n   * @returns {Promise<ErmisClient>} - Connected client\n   */\n  static async connect(serverUrl, userId, options = {}) {\n    const config = {\n      host: serverUrl.replace(/^https?:\\/\\//, \"\"),\n      ...options,\n    };\n\n    const client = new ErmisClient(config);\n    await client.authenticate(userId);\n\n    return client;\n  }\n\n  /**\n   * Get SDK version\n   */\n  static get version() {\n    return VERSION;\n  }\n\n  /**\n   * Get available events\n   */\n  static get events() {\n    return {\n      // Client events\n      CLIENT_AUTHENTICATED: \"authenticated\",\n      CLIENT_AUTHENTICATION_FAILED: \"authenticationFailed\",\n      CLIENT_LOGGED_OUT: \"loggedOut\",\n      CLIENT_CONNECTION_STATUS_CHANGED: \"connectionStatusChanged\",\n\n      // Room events\n      ROOM_CREATED: \"roomCreated\",\n      ROOM_JOINED: \"roomJoined\",\n      ROOM_LEFT: \"roomLeft\",\n\n      // Participant events\n      PARTICIPANT_ADDED: \"participantAdded\",\n      PARTICIPANT_REMOVED: \"participantRemoved\",\n      PARTICIPANT_PINNED: \"participantPinned\",\n      PARTICIPANT_UNPINNED: \"participantUnpinned\",\n      PARTICIPANT_AUDIO_TOGGLED: \"audioToggled\",\n      PARTICIPANT_VIDEO_TOGGLED: \"videoToggled\",\n\n      // Sub room events\n      SUB_ROOM_CREATED: \"subRoomCreated\",\n      SUB_ROOM_JOINED: \"subRoomJoined\",\n      SUB_ROOM_LEFT: \"subRoomLeft\",\n      SUB_ROOM_SWITCHED: \"subRoomSwitched\",\n\n      // Error events\n      ERROR: \"error\",\n    };\n  }\n\n  /**\n   * Media device utilities\n   */\n  static get MediaDevices() {\n    return {\n      /**\n       * Get available media devices\n       */\n      async getDevices() {\n        if (!navigator.mediaDevices?.enumerateDevices) {\n          throw new Error(\"Media devices not supported\");\n        }\n\n        const devices = await navigator.mediaDevices.enumerateDevices();\n\n        return {\n          cameras: devices.filter((d) => d.kind === \"videoinput\"),\n          microphones: devices.filter((d) => d.kind === \"audioinput\"),\n          speakers: devices.filter((d) => d.kind === \"audiooutput\"),\n        };\n      },\n\n      /**\n       * Get user media with constraints\n       */\n      async getUserMedia(constraints = { video: true, audio: true }) {\n        if (!navigator.mediaDevices?.getUserMedia) {\n          throw new Error(\"getUserMedia not supported\");\n        }\n\n        return await navigator.mediaDevices.getUserMedia(constraints);\n      },\n\n      /**\n       * Check for media permissions\n       */\n      async checkPermissions() {\n        const permissions = {};\n\n        if (navigator.permissions) {\n          try {\n            permissions.camera = await navigator.permissions.query({\n              name: \"camera\",\n            });\n            permissions.microphone = await navigator.permissions.query({\n              name: \"microphone\",\n            });\n          } catch (error) {\n            console.warn(\"Permission check failed:\", error);\n          }\n        }\n\n        return permissions;\n      },\n    };\n  }\n\n  /**\n   * Room types constants\n   */\n  static get RoomTypes() {\n    return {\n      MAIN: \"main\",\n      BREAKOUT: \"breakout\",\n      PRESENTATION: \"presentation\",\n      DISCUSSION: \"discussion\",\n    };\n  }\n\n  /**\n   * Connection status constants\n   */\n  static get ConnectionStatus() {\n    return {\n      DISCONNECTED: \"disconnected\",\n      CONNECTING: \"connecting\",\n      CONNECTED: \"connected\",\n      FAILED: \"failed\",\n    };\n  }\n\n  /**\n   * Participant roles constants\n   */\n  static get ParticipantRoles() {\n    return {\n      OWNER: \"owner\",\n      MODERATOR: \"moderator\",\n      PARTICIPANT: \"participant\",\n      OBSERVER: \"observer\",\n    };\n  }\n}\n\n/**\n * Named exports for individual classes\n */\nexport { ErmisClient, Room, SubRoom, Participant, ApiClient, EventEmitter };\n\n/**\n * Default export - Main SDK class\n */\nexport default ErmisClassroom;\n\n/**\n * Usage Examples:\n *\n * // Basic usage\n * import ErmisClassroom from 'ermis-classroom-sdk';\n *\n * const client = ErmisClassroom.create({\n *   host: 'your-server.com:9999',\n *   debug: true\n * });\n *\n * await client.authenticate('teacher@school.com');\n *\n * // Create and join room\n * const room = await client.createRoom({\n *   name: 'Physics Class',\n *   type: ErmisClassroom.RoomTypes.MAIN\n * });\n *\n * // Listen to events\n * client.on(ErmisClassroom.events.PARTICIPANT_ADDED, ({ participant }) => {\n *   console.log('New participant:', participant.userId);\n * });\n *\n * // Create breakout room\n * const breakoutRoom = await client.createSubRoom({\n *   name: 'Group 1',\n *   type: ErmisClassroom.RoomTypes.BREAKOUT,\n *   maxParticipants: 5\n * });\n *\n * // Join breakout room\n * await client.joinSubRoom(breakoutRoom.code);\n *\n * // Return to main room\n * await client.returnToMainRoom();\n *\n * // Alternative connect method\n * const client2 = await ErmisClassroom.connect(\n *   'https://your-server.com:9999',\n *   'student@school.com',\n *   { autoSaveCredentials: true }\n * );\n */\n\n/**\n * Advanced Usage Examples:\n *\n * // Custom storage implementation\n * import ErmisClassroom from 'ermis-classroom-sdk';\n *\n * const customStorage = {\n *   getItem: (key) => sessionStorage.getItem(key),\n *   setItem: (key, value) => sessionStorage.setItem(key, value),\n *   removeItem: (key) => sessionStorage.removeItem(key)\n * };\n *\n * const client = ErmisClassroom.create({\n *   host: 'server.com:9999',\n *   storage: customStorage,\n *   reconnectAttempts: 5,\n *   reconnectDelay: 3000\n * });\n *\n * // Media device management\n * const devices = await ErmisClassroom.MediaDevices.getDevices();\n * console.log('Available cameras:', devices.cameras);\n *\n * // Permission checking\n * const permissions = await ErmisClassroom.MediaDevices.checkPermissions();\n * if (permissions.camera?.state !== 'granted') {\n *   // Request camera permission\n *   await ErmisClassroom.MediaDevices.getUserMedia({ video: true });\n * }\n *\n * // Room management\n * const rooms = await client.getRooms();\n * const mainRoom = rooms.find(r => r.room_type === ErmisClassroom.RoomTypes.MAIN);\n *\n * if (mainRoom) {\n *   await client.joinRoom(mainRoom.room_code);\n * }\n *\n * // Participant management\n * client.on(ErmisClassroom.events.PARTICIPANT_ADDED, ({ participant }) => {\n *   participant.on('audioToggled', ({ enabled }) => {\n *     console.log(`${participant.userId} ${enabled ? 'unmuted' : 'muted'}`);\n *   });\n *\n *   participant.on('pinToggled', ({ pinned }) => {\n *     if (pinned) {\n *       console.log(`${participant.userId} is now pinned`);\n *     }\n *   });\n * });\n *\n * // UI Integration\n * const mainVideoArea = document.getElementById('main-video');\n * const sidebarArea = document.getElementById('sidebar-videos');\n *\n * client.setUIContainers(mainVideoArea, sidebarArea);\n *\n * // Auto-render when room is joined\n * client.on(ErmisClassroom.events.ROOM_JOINED, ({ room }) => {\n *   room.renderParticipantTiles();\n * });\n *\n * // Cleanup on page unload\n * window.addEventListener('beforeunload', () => {\n *   client.cleanup();\n * });\n */\n"],"names":["EventEmitter","constructor","_events","Map","on","event","listener","has","set","get","push","off","listeners","index","indexOf","splice","length","delete","emit","args","forEach","error","console","once","onceWrapper","removeAllListeners","clear","listenerCount","ApiClient","config","host","apiBaseUrl","apiUrl","jwtToken","userId","setAuth","token","apiCall","endpoint","method","body","Error","options","headers","Authorization","JSON","stringify","response","fetch","ok","status","json","getDummyToken","sub","createRoom","roomName","roomType","room_name","room_type","listRooms","page","perPage","list_query","per_page","sort_by","sort_order","conditions","is_active","getRoomById","roomId","joinRoom","roomCode","appName","room_code","app_name","createSubRoom","parentRoomId","subRoomName","subRoomType","parent_room_id","getSubRooms","leaveRoom","membershipId","switchToSubRoom","subRoomCode","room_id","sub_room_code","getRoomMembers","updateRoom","updates","deleteRoom","Participant","streamId","role","isLocal","isAudioEnabled","isVideoEnabled","isPinned","publisher","subscriber","videoElement","tile","connectionStatus","getDisplayName","roleText","localText","createVideoTile","document","createElement","className","setAttribute","innerHTML","_getLocalTileHTML","_getRemoteTileHTML","querySelector","_setupTileEvents","participant","_setupLocalControls","_setupRemoteControls","pinBtn","addEventListener","e","stopPropagation","togglePin","micBtn","camBtn","toggleMicrophone","toggleCamera","audioBtn","toggleRemoteAudio","toggleMic","_updateMicButton","enabled","action","_updateCamButton","toggleAudio","_updateRemoteAudioButton","pinned","classList","toggle","title","setConnectionStatus","statusDiv","textContent","_getStatusText","setPublisher","setSubscriber","cleanup","stop","parentNode","removeChild","getInfo","Publisher","publishUrl","streamType","currentConfig","codec","width","height","framerate","bitrate","kSampleRate","opusBaseTime","opusSamplesSent","opusSamplesPerChunk","opusChunkCount","stream","audioProcessor","videoProcessor","webTransport","webtransportWriter","webtransportReader","isChannelOpen","mediaConfigSent","videoMetadataReady","audioConfig","videoConfig","videoDescription","sequenceNumber","isPublishing","cameraEnabled","micEnabled","onStatusUpdate","message","isError","log","onStreamStart","onStreamStop","wasmInitialized","wasmInitializing","wasmInitPromise","initAudioRecorder","WasmEncoder","onServerEvent","videoEncoder","VideoEncoder","output","handleVideoChunk","bind","init","loadAllDependencies","Promise","resolve","reject","script","src","onload","onerror","head","appendChild","default","then","catch","err","opusModule","Date","now","startPublishing","setupConnection","getMediaStream","startStreaming","turnOffCamera","turnOnCamera","turnOffMic","turnOnMic","srcObject","getVideoTracks","videoOnlyStream","MediaStream","addTrack","constraints","audio","sampleRate","channelCount","echoCancellation","noiseSuppression","video","ideal","frameRate","navigator","mediaDevices","getUserMedia","getDisplayMedia","videoTrack","onended","videoTracks","WebTransport","ready","createBidirectionalStream","readable","writable","getWriter","getReader","setInterval","ping","TextEncoder","encode","sendOverWebTransportStream","value","done","read","msg","TextDecoder","decode","msgJson","parse","startVideoCapture","startOpusAudioStreaming","triggerWorker","Worker","postMessage","track","MediaStreamTrackProcessor","reader","configure","latencyMode","hardwareAcceleration","frameCounter","result","frame","window","videoBaseTimestamp","timestamp","close","encodeQueueSize","keyFrame","audioTrack","getAudioTracks","audioRecorderOptions","encoderApplication","encoderComplexity","encoderFrameSize","timeSlice","audioRecorder","ondataavailable","handleOpusAudioChunk","start","chunk","metadata","decoderConfig","description","codedWidth","codedHeight","trySendMediaConfig","chunkData","ArrayBuffer","byteLength","copyTo","type","packet","createPacketWithHeader","typedArray","dataArray","Uint8Array","performance","numberOfChannels","audioStartPerfTime","Math","floor","frameBytes","len","out","view","DataView","buffer","setUint32","write","data","adjustedTimestamp","safeTimestamp","HEADER_SIZE","MAX_TS","MIN_TS","frameType","uint8ArrayToBase64","bytes","binary","chunkSize","i","subarray","String","fromCharCode","apply","btoa","aConfigBase64","vConfigUint8","vConfigBase64","state","flush","getTracks","isActive","streamInfo","Subscriber","isOwnStream","mediaWorkerUrl","audioWorkletUrl","mstgPolyfillUrl","isStarted","worker","audioWorkletNode","videoGenerator","videoWriter","mediaStream","subscriberId","audioMixer","_updateConnectionStatus","channel","MessageChannel","_loadPolyfill","_initWorker","port2","_initAudioSystem","port1","_initVideoSystem","removeSubscriber","terminate","_cleanupVideoSystem","setAudioMixer","MediaStreamTrackGenerator","warn","channelPort","onmessage","_handleWorkerMessage","mediaUrl","port","reason","addSubscriber","bufferMs","isPlaying","newBufferSize","kind","writer","releaseLock","channelData","timeStamp","audioEnabled","_handleVideoData","previousStatus","AudioMixer","audioContext","mixerNode","outputDestination","subscriberNodes","isInitialized","outputAudioElement","masterVolume","bufferSize","enableEchoCancellation","debug","initialize","_debug","AudioContext","webkitAudioContext","latencyHint","resume","createGain","gain","createMediaStreamDestination","connect","autoplay","style","display","_setupErrorHandlers","isOwnAudio","channelWorkletPort","_loadAudioWorklet","workletNode","AudioWorkletNode","numberOfInputs","numberOfOutputs","outputChannelCount","gainNode","addedAt","_updateOutputAudio","_setupWorkletMessageHandler","subscriberData","disconnect","setSubscriberVolume","volume","normalizedVolume","max","min","setSubscriberMuted","muted","setMasterVolume","getOutputMediaStream","getStats","subscriberCount","size","audioContextState","subscribers","Array","from","entries","map","id","getSubscriberIds","keys","hasSubscriber","suspend","audioWorklet","addModule","includes","onstatechange","hidden","_sleep","ms","setTimeout","Room","name","code","ownerId","apiClient","mediaConfig","participants","localParticipant","subRooms","pinnedParticipant","mainVideoArea","sidebarArea","join","room","joinResponse","stream_id","roomDetails","_updateFromApiData","_setupParticipants","renderParticipantTiles","_setupMediaConnections","values","leave","_cleanupMediaConnections","_cleanupParticipants","subRoomData","subRoom","user_id","subRoomsData","switchResponse","returnToMainRoom","addParticipant","memberData","_setupParticipantEvents","removeParticipant","getParticipant","getParticipants","pinParticipant","_moveParticipantTile","unpinParticipant","unpinnedParticipant","setUIContainers","localTile","contains","participantCount","subRoomCount","participantsData","participantData","_setupLocalPublisher","_setupRemoteSubscriber","webtpUrl","_handleServerEvent","onStatus","joinedParticipant","membership_id","p","roomData","SubRoom","parentRoom","maxParticipants","autoReturn","duration","startTime","isTemporary","allowSelfAssign","_setupSubRoomEvents","joinFromMain","_pauseMediaConnections","joinResult","_startDurationTimer","_resumeMediaConnections","targetSubRoom","fromSubRoom","toSubRoom","inviteParticipant","inviteToSubRoom","assignParticipant","assignToSubRoom","broadcastMessage","broadcastToSubRoom","getRemainingTime","elapsed","remaining","ceil","extendDuration","additionalMinutes","newDuration","setMaxParticipants","limit","current","isFull","isEmpty","hasExpired","remainingTime","warningTime","remainingMinutes","_durationTimer","clearTimeout","remainingMs","_handleExpiry","serialize","participantIds","createdAt","fromSerializedData","ErmisClient","autoSaveCredentials","reconnectAttempts","reconnectDelay","user","isAuthenticated","currentRoom","rooms","storage","getItem","key","localStorage","setItem","removeItem","defaultVideoConfig","defaultAudioConfig","channels","_setupEventHandlers","_attemptAutoLogin","authenticate","_setConnectionStatus","emailRegex","test","tokenResponse","access_token","authenticatedAt","_saveCredentials","logout","_clearCredentials","_ensureAuthenticated","_setupRoomEvents","autoJoin","find","r","getRooms","getCurrentRoom","getRoom","joinSubRoom","sr","mainRoom","previousSubRoom","switchSubRoom","targetSubRoomCode","currentSubRoom","to","getState","roomCount","getConfig","updateConfig","newConfig","enableDebug","disableDebug","eventsToForward","charAt","toUpperCase","slice","_attemptReconnect","savedUserId","savedToken","attempts","VERSION","ErmisClassroom","create","serverUrl","replace","client","version","events","CLIENT_AUTHENTICATED","CLIENT_AUTHENTICATION_FAILED","CLIENT_LOGGED_OUT","CLIENT_CONNECTION_STATUS_CHANGED","ROOM_CREATED","ROOM_JOINED","ROOM_LEFT","PARTICIPANT_ADDED","PARTICIPANT_REMOVED","PARTICIPANT_PINNED","PARTICIPANT_UNPINNED","PARTICIPANT_AUDIO_TOGGLED","PARTICIPANT_VIDEO_TOGGLED","SUB_ROOM_CREATED","SUB_ROOM_JOINED","SUB_ROOM_LEFT","SUB_ROOM_SWITCHED","ERROR","MediaDevices","getDevices","enumerateDevices","devices","cameras","filter","d","microphones","speakers","checkPermissions","permissions","camera","query","microphone","RoomTypes","MAIN","BREAKOUT","PRESENTATION","DISCUSSION","ConnectionStatus","DISCONNECTED","CONNECTING","CONNECTED","FAILED","ParticipantRoles","OWNER","MODERATOR","PARTICIPANT","OBSERVER"],"mappings":"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ACM,MAAMqb,gBAAgBA,GAAG;QACvB,MAAMC,WAAW,GAAG,EAAE,CAAA;QAEtB,IAAI7a,SAAS,CAAC6a,WAAW,EAAE;UACzB,IAAI;YACFA,WAAW,CAACC,MAAM,GAAG,MAAM9a,SAAS,CAAC6a,WAAW,CAACE,KAAK,CAAC;AACrDzM,cAAAA,IAAI,EAAE,QAAA;AACR,aAAC,CAAC,CAAA;YACFuM,WAAW,CAACG,UAAU,GAAG,MAAMhb,SAAS,CAAC6a,WAAW,CAACE,KAAK,CAAC;AACzDzM,cAAAA,IAAI,EAAE,YAAA;AACR,aAAC,CAAC,CAAA;WACH,CAAC,OAAOhc,KAAK,EAAE;AACdC,YAAAA,OAAO,CAACqW,IAAI,CAAC,0BAA0B,EAAEtW,KAAK,CAAC,CAAA;AACjD,WAAA;AACF,SAAA;AAEA,QAAA,OAAOuoB,WAAW,CAAA;AACpB,OAAA;KACD,CAAA;AACH,GAAA;;AAEA;AACF;AACA;EACE,WAAWI,SAASA,GAAG;IACrB,OAAO;AACLC,MAAAA,IAAI,EAAE,MAAM;AACZC,MAAAA,QAAQ,EAAE,UAAU;AACpBC,MAAAA,YAAY,EAAE,cAAc;AAC5BC,MAAAA,UAAU,EAAE,YAAA;KACb,CAAA;AACH,GAAA;;AAEA;AACF;AACA;EACE,WAAWC,gBAAgBA,GAAG;IAC5B,OAAO;AACLC,MAAAA,YAAY,EAAE,cAAc;AAC5BC,MAAAA,UAAU,EAAE,YAAY;AACxBC,MAAAA,SAAS,EAAE,WAAW;AACtBC,MAAAA,MAAM,EAAE,QAAA;KACT,CAAA;AACH,GAAA;;AAEA;AACF;AACA;EACE,WAAWC,gBAAgBA,GAAG;IAC5B,OAAO;AACLC,MAAAA,KAAK,EAAE,OAAO;AACdC,MAAAA,SAAS,EAAE,WAAW;AACtBC,MAAAA,WAAW,EAAE,aAAa;AAC1BC,MAAAA,QAAQ,EAAE,UAAA;KACX,CAAA;AACH,GAAA;AACF,CAAA;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;"}